<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Website to evaluate Visual Regression Tools</title>
  <link rel="stylesheet" href="public/output.css">
  <link rel="icon" href="favicon.ico">
  <link
    href="https://fonts.googleapis.com/css?family=Montserrat:400,600|Fira+Mono:400,500,700|Merriweather:400,700|Roboto:400,500,700&display=swap"
    rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  <style>
    body {
      font-family: 'Raleway', Arial, sans-serif;
    }

    .font-mono {
      font-family: 'Fira Mono', monospace;
    }

    .font-serif {
      font-family: 'Merriweather', serif;
    }

    .side-panel-open {
      right: 0 !important;
    }

    .side-panel-closed {
      right: -400px !important;
    }

    .transition-right {
      transition: right 0.35s cubic-bezier(.4, 2, .6, 1);
    }

    .tab-active {
      background: #4B1FA6;
      color: #fff;
      font-weight: 800;
      border-bottom: 2px solid #fff;
      transform: scale(1.06);
      z-index: 2;
    }

    .tab-inactive {
      background: #ece6fa;
      color: #666;
    }

    .sysval {
      margin-left: 3px;
      color: #666;
      font-size: 0.95em;
      font-weight: 400;
    }

    .sysinfo-row {
      margin-bottom: 12px;
    }

    .sysinfo-hr {
      border: none;
      border-top: 1px solid #ececec;
      margin: 0 0 8px 0;
      width: 90%;
    }

    @keyframes marquee {
      0% {
        transform: translateX(100vw);
      }

      100% {
        transform: translateX(-100vw);
      }
    }

    .animate-marquee {
      animation: marquee 30s linear infinite;
    }

    @keyframes marquee {
      0% {
        transform: translateX(0);
      }

      100% {
        transform: translateX(-50%);
      }
    }

    @keyframes fadeIn {
      from {
        opacity: 0;
      }

      to {
        opacity: 1;
      }
    }

    @keyframes fadeOut {
      to {
        opacity: 0;
      }
    }

    .invert,
    [filter~="invert(1)"] {
      filter: invert(1) hue-rotate(180deg) !important;
    }

    .dark {
      background: #18181b !important;
      color: #f3f4f6 !important;
    }

    .dark input,
    .dark select,
    .dark textarea {
      background: #27272a !important;
      color: #f3f4f6 !important;
    }

    .dark .bg-white {
      background: #27272a !important;
    }

    .dark .text-black {
      color: #f3f4f6 !important;
    }

    .dark .shadow-2xl {
      box-shadow: 0 8px 32px 0 rgba(0, 0, 0, 0.8) !important;
    }

    @media (max-width: 900px) {

      .login-card,
      .flex.max-w-4xl {
        flex-direction: column !important;
        min-height: 0 !important;
        height: auto !important;
      }

      #login-right,
      .flex-1.bg-gradient-to-br {
        min-width: 0 !important;
        height: 220px !important;
        min-height: 220px !important;
        border-radius: 0 0 24px 24px !important;
      }

      #slider-img {
        border-radius: 0 0 24px 24px !important;
        height: 100% !important;
        min-height: 220px !important;
        width: 100% !important;
        object-fit: cover !important;
      }
    }

    @media (max-width: 600px),
    (max-height: 600px) {
      .flex.max-w-4xl {
        min-height: unset !important;
        height: auto !important;
        display: block !important;
        border-radius: 0 !important;
        box-shadow: none !important;
      }

      #login-right,
      .flex-1.bg-gradient-to-br {
        display: none !important;
      }
    }

    @media (max-width: 600px) and (orientation: portrait) {

      #login-right,
      .flex-1.bg-gradient-to-br {
        display: none !important;
      }
    }

    @media (max-width: 900px) and (orientation: portrait) {

      #login-right,
      .flex-1.bg-gradient-to-br {
        display: none !important;
      }
    }

    @media (max-width: 1024px) and (orientation: portrait) {

      #login-right,
      .flex-1.bg-gradient-to-br {
        display: none !important;
      }
    }

    html,
    body {
      overflow-x: hidden;
      overflow-y: auto;
    }

    .container {
      max-width: 1024px;
      margin: 0 auto;
    }

    /* Orientation-specific styles */
    @media (orientation: portrait) {
      #main-card {
        flex-direction: column !important;
        min-height: 0 !important;
        height: auto !important;
        max-width: 98vw !important;
        margin-top: 2vw !important;
      }

      #login-right,
      .flex-1.bg-gradient-to-br {
        min-width: 0 !important;
        height: 180px !important;
        min-height: 180px !important;
        border-radius: 0 0 24px 24px !important;
      }

      #slider-img {
        border-radius: 0 0 24px 24px !important;
        height: 100% !important;
        min-height: 180px !important;
        width: 100% !important;
        object-fit: cover !important;
      }
    }

    @media (orientation: landscape) {
      #main-card {
        flex-direction: row !important;
        min-height: 320px !important;
        max-width: 80vw !important;
        margin-top: 0.5vw !important;
      }

      #login-right,
      .flex-1.bg-gradient-to-br {
        min-width: 220px !important;
        height: auto !important;
        border-radius: 0 24px 24px 0 !important;
      }

      #slider-img {
        border-radius: 0 24px 24px 0 !important;
        height: 100% !important;
        min-height: 220px !important;
        width: 100% !important;
        object-fit: cover !important;
      }
    }

    /* --- Responsive Breakpoints --- */
    /* Mobile: up to 600px */
    @media (max-width: 600px) {
      /* ...existing mobile rules... */
    }

    /* Tablet: up to 900px */
    @media (max-width: 900px) {
      /* ...existing tablet rules... */
    }

    /* Desktop: above 900px */
    /* Default layout applies */
    .high-contrast-img {
      filter: contrast(2) brightness(1.2) !important;
    }

    .distorted-img {
      filter: none !important;
    }

    body.dark footer {
      background-color: #18181b !important;
      color: #e5e7eb !important;
    }

    /* --- Fix for Bento Grid --- */
    #login-right {
      min-height: 320px;
      height: 100%;
      position: relative;
    }

    #bento-grid {
      display: grid !important;
      grid-template-areas:
        "react react vue angular"
        "node central central svelte"
        "ts central central graphql"
        "webpack vite rest rest";
      grid-template-rows: 1fr 1.2fr 1.2fr 1fr;
      grid-template-columns: 1.1fr 1.2fr 1.2fr 1.1fr;
      gap: 10px;
      position: absolute;
      inset: 0;
      width: 100%;
      height: 100%;
      box-sizing: border-box;
      padding: 12px;
      z-index: 30;
      background: #f3f4f6;
    }

    #countdown-timer {
      white-space: nowrap;
    }
  </style>
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Raleway:400,600,700&display=swap">
</head>

<body class="bg-purple-100 min-h-screen flex flex-col justify-center items-center dark">
  <!-- Skeleton Loader Overlay -->
  <div id="skeleton-loader"
    style="display:none; position:fixed; inset:0; z-index:5000; background:rgba(245,240,255,0.98);">
    <div class="flex flex-col min-h-screen w-full h-full">
      <div class="h-20 flex items-center justify-center w-full animate-pulse">
        <div class="h-8 w-64 bg-purple-200 rounded-xl mx-auto"></div>
      </div>
      <div class="flex flex-1 items-center justify-center w-full">
        <div
          class="flex w-full max-w-4xl rounded-3xl bg-white/80 overflow-hidden shadow-2xl mt-8 items-stretch min-h-[320px] h-auto md:h-[420px] lg:h-[480px] xl:h-[520px]">
          <div
            class="flex-1 p-8 flex flex-col justify-center h-full min-w-[420px] md:min-w-[480px] gap-4 animate-pulse">
            <div class="flex items-center mb-2 gap-4">
              <div class="w-8 h-4 bg-purple-200 rounded-full"></div>
              <div class="h-8 w-32 bg-gray-200 rounded"></div>
              <div class="flex gap-2">
                <div class="w-8 h-8 bg-purple-100 rounded-full"></div>
                <div class="w-8 h-8 bg-purple-100 rounded-full"></div>
                <div class="w-8 h-8 bg-purple-100 rounded-full"></div>
              </div>
            </div>
            <div class="h-4 w-48 bg-gray-200 rounded mb-4"></div>
            <div class="h-12 w-full bg-gray-200 rounded mb-2"></div>
            <div class="h-12 w-full bg-gray-200 rounded mb-2"></div>
            <div class="h-6 w-1/2 bg-gray-200 rounded mb-2"></div>
            <div class="h-10 w-full bg-purple-200 rounded mb-2"></div>
            <div class="h-4 w-32 bg-gray-100 rounded mx-auto mb-2"></div>
            <div class="grid grid-cols-3 gap-2 w-full mx-auto mt-2">
              <div class="h-10 w-24 bg-gray-200 rounded"></div>
              <div class="h-10 w-24 bg-gray-200 rounded"></div>
              <div class="h-10 w-24 bg-gray-200 rounded"></div>
            </div>
          </div>
          <div
            class="flex-1 bg-gradient-to-br from-purple-200 to-purple-400 flex items-center justify-center relative min-w-[220px] h-full animate-pulse">
            <div class="w-64 h-64 bg-gray-300 rounded-3xl"></div>
          </div>
        </div>
      </div>
      <div class="h-16 w-full flex items-center justify-center animate-pulse">
        <div class="h-6 w-96 bg-purple-200 rounded-xl"></div>
      </div>
    </div>
    <style>
      @keyframes skeletonShimmer {
        0% {
          background-position: -400px 0;
        }

        100% {
          background-position: 400px 0;
        }
      }

      #skeleton-loader .bg-gray-200,
      #skeleton-loader .bg-purple-200,
      #skeleton-loader .bg-gray-100,
      #skeleton-loader .bg-gray-300 {
        background: linear-gradient(90deg, #ece6fa 25%, #f3f0fa 50%, #ece6fa 75%);
        background-size: 400px 100%;
        animation: skeletonShimmer 1.2s infinite linear;
      }
    </style>
  </div>
  <div id="static-banner" style="display:none;"
    class="fixed top-0 left-0 w-full bg-purple-700 text-gray-100 text-center py-3 px-4 font-semibold text-base shadow-xl z-[3000]"
    role="alert">
    <span class="font-bold">Reminder:</span> Visual Regression detects UI changes between release versions.
  </div>
  <!-- Decorative Background Lines/Curves -->
  <svg class="background-lines pointer-events-none fixed top-0 left-0 w-full h-full z-[-10]" width="100%" height="100%"
    viewBox="0 0 1440 900" fill="none" xmlns="http://www.w3.org/2000/svg">
    <path d="M0,200 Q400,400 900,100 Q1200,0 1440,200" stroke="#d1b3ff" stroke-width="3" fill="none" />
    <path d="M0,700 Q600,900 1440,600" stroke="#d1b3ff" stroke-width="2" fill="none" />
  </svg>
  <!-- Decorative Background Lines/Curves -->
  <h1 class="text-2xl md:text-3xl font-extrabold text-purple-700 text-center tracking-tight mt-4 mb-2">Visual Regression
    Tester</h1>
  <!-- Login Card -->
  <div id="main-card"
    class="flex w-full max-w-4xl rounded-3xl bg-white overflow-hidden mt-2 items-stretch min-h-[320px] h-auto md:h-[420px] lg:h-[480px] xl:h-[520px] z-[100]">
    <!-- Login Left -->
    <div id="login-left" class="flex-1 p-8 flex flex-col justify-center h-full min-w-[220px] w-1/2">
      <div class="flex items-center mb-2 justify-between">
        <span class="inline-block w-8 h-4 bg-purple-200 rounded-full mr-2"></span>
        <h2 class="text-2xl font-bold" id="login-heading">Log In</h2>
        <div id="header-btn-group" class="flex gap-2 mb-2 transition-all duration-300">
          <button
            class="flex items-center justify-center w-8 h-8 rounded-full text-purple-400 text-lg shadow cursor-pointer hover:bg-purple-100 transition"
            id="open-side-panel-btn" title="Info"><i class="fa-solid fa-wrench"></i></button>

          <button id="lang-icon"
            class="flex items-center justify-center w-8 h-8 rounded-full text-purple-400 text-lg shadow cursor-pointer hover:bg-purple-100 transition"
            title="Switch Language"><i class="fa-solid fa-globe"></i></button>
          <button
            class="flex items-center justify-center w-8 h-8 rounded-full text-purple-400 text-lg shadow cursor-pointer hover:bg-purple-100 transition"
            id="about-btn" title="About Us"><i class="fa-solid fa-info"></i></button>
          <button id="theme-toggle"
            class="flex items-center justify-center w-8 h-8 rounded-full text-purple-400 text-lg shadow cursor-pointer hover:bg-purple-100 transition"
            title="Toggle Dark/Light Mode"></button>
          <button id="help-icon"
            class="flex items-center justify-center w-8 h-8 rounded-full text-purple-400 text-lg shadow cursor-pointer hover:bg-purple-100 transition"
            title="Settings"><i class="fa-solid fa-cog"></i></button>
        </div>
      </div>
      <p class="text-gray-400 mb-6" id="login-subtitle">Welcome back! Please enter your details</p>
      <form class="space-y-3" id="login-form" autocomplete="off">
        <div id="login-fields">
          <div class="mb-2 relative">
            <label class="block mb-1 font-medium" for="email">Email</label>
            <input class="w-full px-3 py-2 border rounded-md" type="email" id="email" name="email"
              placeholder="Enter your email">
          </div>
          <div class="mb-2 relative">
            <label class="block mb-1 font-medium" for="password">Password</label>
            <input class="w-full px-3 py-2 border rounded-md pr-10" type="password" id="password" name="password"
              placeholder="Enter your password">
            <span class="absolute right-3 top-9 text-gray-400 cursor-pointer text-lg" onclick="togglePassword()"><i
                class="fa-regular fa-eye" id="eyeIcon"></i></span>
          </div>
          <div class="flex items-center justify-between mb-2">
            <label class="flex items-center gap-2 text-sm">
              <input type="checkbox" id="remember-me" class="accent-purple-500">
              <span>Remember me</span>
            </label>
            <a href="#" class="text-purple-500 text-sm inline-block" id="forgot-link">forgot password?</a>
          </div>
          <button type="submit" id="login-btn"
            class="w-full py-2 bg-purple-500 text-white rounded-md font-semibold hover:bg-purple-600 transition mb-2 disabled:bg-gray-300 disabled:text-gray-500 disabled:cursor-not-allowed"
            style="transition: background 0.2s, color 0.2s;" disabled>Log in</button>
          <div id="welcome-message" class="hidden text-center text-lg font-bold text-purple-700 my-6"></div>
          <div id="logout-row" class="hidden text-center my-4">
            <button id="logout-btn"
              class="px-6 py-2 bg-gray-200 text-purple-700 rounded font-semibold shadow hover:bg-gray-300 transition">Log
              out</button>
          </div>
          <div class="grid grid-cols-3 gap-2 mb-2 w-full mx-auto" style="grid-template-columns: repeat(3, 1fr);">
            <button type="button"
              class="border rounded-md py-2 w-32 mx-auto flex items-center justify-center gap-2 text-red-500 text-sm"><i
                class="fab fa-google"></i> Google</button>
            <button type="button"
              class="border rounded-md py-2 w-32 mx-auto flex items-center justify-center gap-2 text-blue-600 text-sm"><i
                class="fab fa-facebook-f"></i> Facebook</button>
            <button type="button"
              class="border rounded-md py-2 w-32 mx-auto flex items-center justify-center gap-2 text-black text-sm"><i
                class="fab fa-apple"></i> Apple</button>
            <button type="button"
              class="border rounded-md py-2 w-32 mx-auto flex items-center justify-center gap-2 text-blue-700 text-sm"><i
                class="fab fa-linkedin-in"></i> LinkedIn</button>
            <button type="button"
              class="border rounded-md py-2 w-32 mx-auto flex items-center justify-center gap-2 text-blue-800 text-sm"><i
                class="fab fa-microsoft"></i> Microsoft</button>
            <button type="button"
              class="border rounded-md py-2 w-32 mx-auto flex items-center justify-center gap-2 text-sky-400 text-sm"><i
                class="fab fa-twitter"></i> Twitter</button>
          </div>
        </div>
        <div id="forgot-fields" style="display:none;">
          <div class="mb-2">
            <label class="block mb-1 font-medium" for="forgot-email">Email</label>
            <input class="w-full px-3 py-2 border rounded-md" type="email" id="forgot-email" name="forgot-email"
              placeholder="Enter your email">
          </div>
          <button type="submit"
            class="w-full py-2 bg-purple-500 text-white rounded-md font-semibold hover:bg-purple-600 transition mb-2">Send
            Reset Link</button>
          <a href="#" class="text-purple-500 text-sm mb-2 inline-block" id="back-to-login">Back to Login</a>
        </div>
        <div id="signup-fields" style="display:none;">
          <div class="mb-2">
            <label class="block mb-1 font-medium" for="signup-name">Name</label>
            <input class="w-full px-3 py-2 border rounded-md" type="text" id="signup-name" name="signup-name"
              placeholder="Enter your name">
          </div>
          <div class="mb-2">
            <label class="block mb-1 font-medium" for="signup-email">Email</label>
            <input class="w-full px-3 py-2 border rounded-md" type="email" id="signup-email" name="signup-email"
              placeholder="Enter your email">
          </div>
          <div class="mb-2">
            <label class="block mb-1 font-medium" for="signup-password">Password</label>
            <input class="w-full px-3 py-2 border rounded-md" type="password" id="signup-password"
              name="signup-password" placeholder="Enter your password">
          </div>
          <div class="mb-2">
            <label class="block mb-1 font-medium" for="signup-confirm">Confirm Password</label>
            <input class="w-full px-3 py-2 border rounded-md" type="password" id="signup-confirm" name="signup-confirm"
              placeholder="Confirm your password">
          </div>
          <button type="submit" id="signup-btn"
            class="w-full py-2 bg-purple-500 text-white rounded-md font-semibold hover:bg-purple-600 transition mb-2"
            disabled>Sign Up</button>
          <a href="#" class="text-purple-500 text-sm mb-2 inline-block" id="back-to-login-signup">Back to Login</a>
        </div>
      </form>
      <div class="flex items-center justify-between mt-4 w-full">
        <div id="countdown-timer" class="hidden text-left text-purple-500 font-semibold"></div>
        <div id="signup-link-row" class="flex justify-end w-full text-gray-400"><span>Don't have account?<a href="#"
              class="text-purple-500 ml-1" id="show-signup">Sign Up</a></span></div>
      </div>
    </div>
    <!-- Login Right -->
    <div id="login-right"
      class="flex-1 bg-gradient-to-br from-purple-200 to-purple-400 flex items-stretch justify-center relative min-w-[220px] w-1/2 h-full">
      <img id="slider-img" class="w-full h-full object-cover rounded-r-3xl"
        src="https://images.unsplash.com/photo-1513258496099-48168024aec0?auto=format&fit=crop&w=540&q=80"
        alt="Login Visual" />
      <div id="slider-dots"
        class="absolute left-1/2 bottom-4 transform -translate-x-1/2 flex gap-2 bg-black bg-opacity-10 px-4 py-1 rounded-xl">
      </div>
    </div>
  </div>
  <!-- System Info Side Panel -->
  <div id="side-panel"
    class="fixed top-0 left-[-400px] w-[340px] h-full bg-white shadow-lg z-50 transition-right flex flex-col rounded-r-2xl">
    <button id="side-panel-close" class="absolute top-3 left-4 text-2xl text-purple-500">&times;</button>
    <div class="p-0 pt-10 overflow-y-auto flex-1">
      <div class="font-bold text-lg mb-2 px-6">System Info</div>
      <div id="side-panel-content" class="text-xs text-gray-700 px-6 py-4">
        <!-- Dynamic system info will be injected here -->
      </div>
    </div>
  </div>
  <!-- Visual Regression Parameters Right Panel -->
  <div id="help-panel"
    class="fixed top-0 right-[-400px] w-[400px] h-full bg-white shadow-lg z-50 transition-right flex flex-col rounded-l-2xl">
    <button id="help-close" class="absolute top-3 right-4 text-2xl text-purple-500">&times;</button>
    <div class="p-0 pt-10 overflow-y-auto flex-1">
      <div class="flex items-center justify-between mb-2 px-6">
        <span class="font-bold text-lg">Visual Regression Parameters</span>
        <button id="param-reset" type="button"
          class="text-purple-500 hover:text-purple-700 text-xl p-1 rounded-full focus:outline-none"
          title="Reset Parameters">
          <i class="fa-solid fa-rotate-right"></i>
        </button>
      </div>
      <div id="param-tabs" class="flex gap-1 mb-4 px-6"></div>
      <div id="param-form" class="grid grid-cols-1 gap-4 mb-4 px-6"></div>
    </div>
  </div>
  <!-- Popup Modal -->
  <div id="popup-modal"
    class="hidden fixed top-0 left-0 w-full h-full bg-black bg-opacity-45 z-[3000] flex items-center justify-center">
    <div
      class="bg-white p-8 rounded-2xl shadow-2xl w-[60vw] max-w-[400px] text-center relative flex flex-col items-center border border-gray-200 dark:border-gray-700">
      <button id="popup-close"
        class="absolute top-3 right-4 text-2xl text-purple-500 hover:text-purple-700 transition">&times;</button>
      <div class="text-2xl font-bold text-gray-800 dark:text-gray-100 mb-2 flex items-center gap-2"><i
          class="fa-solid fa-circle-info text-purple-500"></i> Visual Regression Modal</div>
      <div class="mb-4 text-gray-600 dark:text-gray-300">This is a realistic popup/modal. You triggered this by adding
        <b>popup=on</b> to the URL or toggling Visual Regression Parameters.<br><br>Popups are useful for onboarding,
        warnings, confirmations, and more. You can style and animate them as needed.
      </div>
      <button id="popup-action"
        class="mt-2 px-5 py-2 bg-purple-500 text-white rounded-lg font-semibold shadow hover:bg-purple-600 transition">Got
        it!</button>
    </div>
  </div>
  <!-- Cookie Banner -->
  <div id="cookie-banner"
    class="hidden fixed left-1/2 bottom-8 bg-yellow-100 text-gray-900 shadow-xl px-8 py-6 flex items-start justify-between z-[1000] text-base rounded-xl border-2 border-yellow-400 min-w-[320px] max-w-[600px] -translate-x-1/2">
    <div class="flex-1 min-w-0">
      We use essential cookies to make our site work. With your consent, we may also use non-essential cookies to
      improve user experience and analyze website traffic. By clicking "Accept", you agree to our website's cookie use
      as described in our <a href="#" class="text-yellow-700 underline font-semibold">Cookie Policy</a>. You can change
      your cookie settings at any time by clicking "Preferences."
    </div>
    <div class="flex flex-col gap-2 min-w-[180px] ml-4">
      <button
        class="cookie-btn-prefs bg-white border-2 border-yellow-400 rounded-md px-4 py-2 font-bold text-yellow-700 hover:bg-yellow-200">Preferences</button>
      <button
        class="cookie-btn-decline bg-yellow-50 border-2 border-yellow-500 rounded-md px-4 py-2 font-bold text-yellow-700 hover:bg-yellow-200">Decline</button>
      <button
        class="cookie-btn-accept bg-yellow-400 border-2 border-yellow-500 rounded-md px-4 py-2 font-bold text-white hover:bg-yellow-500">Accept</button>
    </div>
  </div>
  <!-- Scrolling Banner -->
  <div id="scrolling-banner"
    class="hidden fixed top-0 left-0 w-full min-h-[64px] bg-cover bg-center z-[2000] flex items-center shadow-md text-white text-lg font-bold overflow-hidden"
    style="background-image:url('https://images.unsplash.com/photo-1506744038136-46273834b3fb?auto=format&fit=crop&w=1200&q=80');">
    <div class="bg-black bg-opacity-50 px-8 py-3 rounded-xl max-w-full whitespace-nowrap animate-marquee">
      Visual Regression Testing Mode Active — Dynamic UI changes enabled for testing — Try different parameters for
      font, color, layout, and image — Test accessibility and responsiveness — Simulate visual bugs and edge cases —
      Easily reset or combine features for robust regression testing
    </div>
  </div>
  <!-- Overlay for panels -->
  <div id="panel-overlay" class="fixed inset-0 bg-black bg-opacity-40 z-40 hidden transition-opacity duration-300">
  </div>
  <footer
    class="fixed bottom-0 left-0 w-full text-white text-center py-3 px-4 font-semibold text-base shadow-xl z-[3000] flex justify-between items-center flex-wrap bg-purple-400 dark:bg-gray-900 dark:text-gray-200">
    <span class="footer-left">
      <a href="https://github.com/vijopv83/VisualRegressionTester" target="_blank"
        class="underline text-white font-bold">
        GitHub
      </a>: ⭐ the repo, open an issue, or submit a pull request!
    </span>
    <span class="footer-right">
      Creator. Builder. Curious? Let's talk →
      <a href="https://www.linkedin.com/in/vijopv83" target="_blank" rel="noopener noreferrer"
        class="underline text-white font-bold">
        linkedin.com/in/vijopv83
      </a>
    </span>
  </footer>

  <!-- Language Modal -->
  <div id="lang-modal" class="hidden fixed inset-0 flex items-center justify-center z-[3000] bg-black bg-opacity-40">
    <div
      class="bg-white p-8 rounded-2xl shadow-2xl w-[90vw] max-w-[340px] text-center relative flex flex-col items-center border border-gray-200">
      <button id="lang-modal-close"
        class="absolute top-3 right-4 text-2xl text-purple-500 hover:text-purple-700 transition">&times;</button>
      <div class="text-lg font-bold text-gray-800 mb-4">Your language</div>
      <select id="lang-select"
        class="w-full border border-gray-300 rounded px-3 py-2 mb-2 focus:outline-none focus:ring-2 focus:ring-purple-400">
        <option value="">Select a language...</option>
        <option value="en">English (English)</option>
        <option value="ar">Arabic (العربية)</option>
        <option value="bn">Bengali (বাংলা)</option>
        <option value="zh">Chinese (中文)</option>
        <option value="ja">Japanese (日本語)</option>
        <option value="ko">Korean (한국어)</option>
        <option value="ru">Russian (Русский)</option>
        <option value="el">Greek (Ελληνικά)</option>
        <option value="he">Hebrew (עברית)</option>
        <option value="th">Thai (ไทย)</option>
        <option value="nl">Dutch (Nederlands)</option>
        <option value="fr">French (français)</option>
        <option value="de">German (Deutsch)</option>
        <option value="hi">Hindi (हिन्दी)</option>
        <option value="it">Italian (italiano)</option>
        <option value="ml">Malayalam (മലയാളം)</option>
        <option value="mr">Marathi (मराठी)</option>
        <option value="es">Spanish (español)</option>
        <option value="te">Telugu (తెలుగు)</option>
      </select>
      <button id="lang-apply"
        class="w-full mt-2 px-4 py-2 bg-purple-500 text-white rounded font-semibold shadow hover:bg-purple-600 transition">Apply</button>
    </div>
  </div>
  <!-- About Us Infinite Scroll Overlay -->
  <div id="about-overlay"
    class="hidden fixed inset-0 z-[9999] bg-gradient-to-br from-[#ede9fe] to-[#f3f0fa] dark:bg-gray-900"
    style="transition:opacity 0.3s; min-height:100vh; overflow-y:auto; max-height:100vh; box-shadow: 0 8px 48px 0 rgba(75,31,166,0.18); backdrop-filter: blur(6px);">
    <button id="about-close"
      class="absolute top-4 right-4 md:right-8 text-3xl text-purple-500 hover:text-purple-700 font-bold z-10">&times;</button>
    <h2 class="text-2xl md:text-3xl font-extrabold text-purple-700 mt-8 md:mt-12 mb-4 text-center px-2">About Us</h2>
    <div class="w-full max-w-2xl flex flex-col items-center px-2 sm:px-4 pb-8 m-2 sm:m-4 md:m-8">
      <div
        class="bg-white dark:bg-gray-900 dark:border-gray-600 dark:text-gray-100 rounded-xl p-3 sm:p-5 shadow-lg border border-purple-100 dark:shadow-2xl backdrop-blur-md transition-transform duration-200 hover:scale-105 hover:shadow-2xl mb-8 w-full"
        style="box-shadow: 0 4px 24px 0 rgba(75,31,166,0.10);">
        <p class="text-base sm:text-lg text-gray-700 mb-4">Visual Regression Tester is a modern playground for
          evaluating and comparing visual regression tools. It's designed to help you catch UI changes, layout bugs, and
          edge-case rendering issues across different software releases. You'll be able to compare how each
          visual-regression tool handles dynamic content, theming, animations, and edge-case layouts more
          thoroughly.</b></p>
        <p class="text-sm sm:text-base text-gray-600 mb-2">This page demonstrates a wide range of real-world UI features
          and states that are critical for robust visual testing:</p>
        <div class="overflow-x-auto mb-6 w-full flex justify-center">
          <table
            class="min-w-full border border-purple-200 dark:border-gray-600 rounded-lg text-xs sm:text-sm mb-4 mx-auto dark:bg-gray-900 dark:text-gray-100">
            <thead class="bg-purple-100 dark:bg-gray-800 dark:text-purple-300">
              <tr>
                <th class="px-2 sm:px-3 py-2 text-left font-bold">Feature Category</th>
                <th class="px-2 sm:px-3 py-2 text-left font-bold">Specific Component</th>
                <th class="px-2 sm:px-3 py-2 text-left font-bold">Why It Matters</th>
              </tr>
            </thead>
            <tbody class="bg-white dark:bg-gray-900 dark:text-gray-100">
              <tr>
                <td class="border-t px-3 py-3">Data & Dynamic Content</td>
                <td class="border-t px-3 py-3">Infinite-scroll / "Load more" data table</td>
                <td class="border-t px-3 py-3">Tests dynamic row insertion and scroll-state diffs</td>
              </tr>
              <tr>
                <td class="border-t px-3 py-2">Lazy Loading</td>
                <td class="border-t px-3 py-2">Images or widgets that load on scroll</td>
                <td class="border-t px-3 py-2">Catches loading placeholders vs. final content</td>
              </tr>
              <tr>
                <td class="border-t px-3 py-2">Notifications & Alerts</td>
                <td class="border-t px-3 py-2">Toast/snackbar notifications</td>
                <td class="border-t px-3 py-2">Validates pop-in/out animations and timing changes</td>
              </tr>
              <tr>
                <td class="border-t px-3 py-2">Interactive States</td>
                <td class="border-t px-3 py-2">Hover/focus/active states on controls</td>
                <td class="border-t px-3 py-2">Ensures pseudo-class styling is captured</td>
              </tr>
              <tr>
                <td class="border-t px-3 py-2">Accordion / Tabs</td>
                <td class="border-t px-3 py-2">Expandable panels or tabbed content</td>
                <td class="border-t px-3 py-2">Checks content-toggle animations and layout shifts</td>
              </tr>
              <tr>
                <td class="border-t px-3 py-2">Theming & Dark-Mode</td>
                <td class="border-t px-3 py-2">Light ↔ Dark color-scheme toggle</td>
                <td class="border-t px-3 py-2">Verifies theme-switching consistency</td>
              </tr>
              <tr>
                <td class="border-t px-3 py-2">Animations & Transitions</td>
                <td class="border-t px-3 py-2">Keyframe or CSS transition examples</td>
                <td class="border-t px-3 py-2">Tests diff resilience to motion blur or timing</td>
              </tr>
              <tr>
                <td class="border-t px-3 py-2">Text & Localization</td>
                <td class="border-t px-3 py-2">Long text wrapping, RTL language support</td>
                <td class="border-t px-3 py-2">Ensures layout adapts to varying text lengths</td>
              </tr>
              <tr>
                <td class="border-t px-3 py-2">Vector & Bitmap Graphics</td>
                <td class="border-t px-3 py-2">Inline SVG icons, CSS gradients</td>
                <td class="border-t px-3 py-2">Validates resolution-independent graphics</td>
              </tr>
              <tr>
                <td class="border-t px-3 py-2">Canvas / WebGL</td>
                <td class="border-t px-3 py-2">&lt;canvas&gt; chart or 3D object</td>
                <td class="border-t px-3 py-2">Captures bitmap vs. vector rendering differences</td>
              </tr>
              <tr>
                <td class="border-t px-3 py-2">Stateful Components</td>
                <td class="border-t px-3 py-2">Toggle/switch with persisted state</td>
                <td class="border-t px-3 py-2">Verifies state-preservation across reloads</td>
              </tr>
              <tr>
                <td class="border-t px-3 py-2">Carousel / Slider</td>
                <td class="border-t px-3 py-2">Image/content carousel with controls</td>
                <td class="border-t px-3 py-2">Tests multi-frame snapshot sequencing</td>
              </tr>
              <tr>
                <td class="border-t px-3 py-2">Accessibility Features</td>
                <td class="border-t px-3 py-2">High-contrast mode, focus outlines</td>
                <td class="border-t px-3 py-2">Ensures WCAG-related style changes are detected</td>
              </tr>
              <tr>
                <td class="border-t px-3 py-2">Performance States</td>
                <td class="border-t px-3 py-2">Skeleton loaders or "slow network" mocks</td>
                <td class="border-t px-3 py-2">Checks placeholder vs. final render transitions</td>
              </tr>
            </tbody>
          </table>
        </div>
        <hr class="my-8 border-purple-200">
        <div class="w-full mt-4">
          <h3
            class="text-2xl md:text-3xl font-extrabold text-purple-800 dark:text-purple-300 mb-6 tracking-tight text-center drop-shadow">
            Popular Visual Regression Tools</h3>
          <div class="grid gap-8 sm:grid-cols-1 md:grid-cols-2">
            <!-- Applitools Eyes -->
            <div
              class="relative bg-white dark:bg-gray-900 dark:border-gray-600 dark:text-gray-100 rounded-2xl p-7 shadow-xl border border-purple-200 dark:border-gray-600 backdrop-blur-md transition-transform duration-200 hover:scale-105 hover:shadow-2xl hover:border-purple-400 dark:hover:border-purple-500 w-full dark:text-gray-100"
              style="box-shadow: 0 8px 36px 0 rgba(124,58,237,0.13);">
              <div class="flex items-center mb-4 mt-1 ml-1 dark:text-purple-200">
                <span class="text-3xl mr-4 flex-shrink-0">🧠</span>
                <span class="font-bold text-xl sm:text-2xl text-purple-800 dark:text-purple-300 drop-shadow">Applitools
                  Eyes</span>
              </div>
              <div class="text-xs text-gray-500 dark:text-gray-300 mb-3 ml-1">AI-powered visual testing (Visual AI)
              </div>
              <ul class="text-sm text-gray-700 dark:text-gray-200 mb-1 ml-1" style="line-height:1.8; font-weight: 400;">
                <li><b>Best For:</b> Dynamic UI, cross-browser, responsive testing, CI/CD pipelines</li>
                <li><b>Strengths:</b> Uses AI to detect meaningful visual differences instead of raw pixel diffs.
                  Handles dynamic content, animations, and font rendering discrepancies better than pixel-based tools.
                </li>
                <li><b>Weaknesses:</b> Requires login/account. Not fully open-source.</li>
                <li><b>Good For Testing:</b> <span class="text-green-700">Theming, dynamic content, animation, RTL text,
                    skeleton loaders, cross-device breakpoints</span></li>
                <li><b>Limitations:</b> <span class="text-red-600">Canvas/WebGL rendering diffs might be ignored or
                    flagged incorrectly unless configured</span></li>
              </ul>
            </div>
            <!-- Percy -->
            <div
              class="bg-white dark:bg-gray-900 dark:border-gray-600 dark:text-gray-100 rounded-xl p-5 shadow-lg border border-purple-100 dark:border-gray-600 backdrop-blur-md transition-transform duration-200 hover:scale-105 hover:shadow-2xl hover:border-purple-400 dark:hover:border-purple-500 w-full"
              style="box-shadow: 0 4px 24px 0 rgba(75,31,166,0.10);">
              <div class="flex items-center mb-1 dark:text-purple-200"><span class="text-2xl mr-2">☁️</span><span
                  class="font-bold text-purple-800 dark:text-purple-300">Visual Regression Testing Cloud (by
                  LambdaTest)</span></div>
              <div class="text-xs text-gray-500 dark:text-gray-300 mb-1">Cloud-based visual regression platform</div>
              <ul class="text-sm text-gray-700 dark:text-gray-200 mb-1">
                <li><b>Best For:</b> Cross-browser & cross-device UI consistency checks</li>
                <li><b>Strengths:</b> Supports Selenium, Cypress, Playwright, Puppeteer, Parallel screenshot comparison
                  on 3000+ browser/OS/device combos, CI/CD integration with GitHub Actions, GitLab CI, Jenkins, CircleCI
                </li>
                <li><b>Weaknesses:</b> Snapshot timing can affect accuracy if content loads asynchronously, Cloud-only
                </li>
                <li><b>Good For Testing:</b> <span class="text-green-700">Form states, light/dark themes, image
                    comparisons, hover/focus states (if scripted)</span></li>
                <li><b>Limitations:</b> <span class="text-yellow-700">May miss animation glitches or JS-rendered changes
                    if snapshots run too early, Limited awareness of semantic layout intent or canvas behavior</span>
                </li>
              </ul>
            </div>
            <div
              class="bg-white dark:bg-gray-900 dark:border-gray-600 dark:text-gray-100 rounded-xl p-5 shadow-lg border border-purple-100 dark:border-gray-600 backdrop-blur-md transition-transform duration-200 hover:scale-105 hover:shadow-2xl hover:border-purple-400 dark:hover:border-purple-500 w-full"
              style="box-shadow: 0 4px 24px 0 rgba(75,31,166,0.10);">
              <div class="flex items-center mb-1 dark:text-purple-200"><span class="text-2xl mr-2">📸</span><span
                  class="font-bold text-purple-800 dark:text-purple-300">Percy (by BrowserStack)</span></div>
              <div class="text-xs text-gray-500 dark:text-gray-300 mb-1">Screenshot-based visual testing with DOM
                snapshot rendering</div>
              <ul class="text-sm text-gray-700 dark:text-gray-200 mb-1">
                <li><b>Best For:</b> CI integration (GitHub, GitLab, Bitbucket), component-based UIs</li>
                <li><b>Strengths:</b> Automatically takes snapshots per commit/branch. Good for collaboration, and works
                  with frameworks like Cypress, Playwright, Selenium</li>
                <li><b>Weaknesses:</b> May miss layout glitches due to content loading after snapshot</li>
                <li><b>Good For Testing:</b> <span class="text-green-700">Form states, light/dark themes, image
                    comparisons, hover/focus states (if scripted)</span></li>
                <li><b>Limitations:</b> <span class="text-yellow-700">Not real-browser-based—some animations and
                    JS-rendered components may be skipped</span></li>
              </ul>
            </div>
            <!-- BackstopJS -->
            <div
              class="bg-white dark:bg-gray-900 dark:border-gray-600 dark:text-gray-100 rounded-xl p-5 shadow-lg border border-purple-100 dark:border-gray-600 backdrop-blur-md transition-transform duration-200 hover:scale-105 hover:shadow-2xl hover:border-purple-400 dark:hover:border-purple-500 w-full"
              style="box-shadow: 0 4px 24px 0 rgba(75,31,166,0.10);">
              <div class="flex items-center mb-1 dark:text-purple-200"><span class="text-2xl mr-2">🟦</span><span
                  class="font-bold text-purple-800 dark:text-purple-300">BackstopJS</span></div>
              <div class="text-xs text-gray-500 dark:text-gray-300 mb-1">Open-source pixel-by-pixel comparison tool
              </div>
              <ul class="text-sm text-gray-700 dark:text-gray-200 mb-1">
                <li><b>Best For:</b> Static and semi-dynamic UI testing, local dev automation</li>
                <li><b>Strengths:</b> CLI based, configurable viewports, interactive diff viewer, works well for
                  pixel-perfect layouts</li>
                <li><b>Weaknesses:</b> Sensitive to anti-aliasing, dynamic content (e.g., timestamps) causes false
                  positives</li>
                <li><b>Good For Testing:</b> <span class="text-green-700">Static layout, responsiveness, hover states,
                    tab panels, pseudo-elements</span></li>
                <li><b>Limitations:</b> <span class="text-red-600">Animations, canvas, slow-load elements unless frozen
                    during snapshot</span></li>
              </ul>
            </div>
            <!-- Katalon Studio -->
            <div
              class="bg-white dark:bg-gray-900 dark:border-gray-600 dark:text-gray-100 rounded-xl p-5 shadow-lg border border-purple-100 dark:border-gray-600 backdrop-blur-md transition-transform duration-200 hover:scale-105 hover:shadow-2xl hover:border-purple-400 dark:hover:border-purple-500 w-full"
              style="box-shadow: 0 4px 24px 0 rgba(75,31,166,0.10);">
              <div class="flex items-center mb-1 dark:text-purple-200"><span class="text-2xl mr-2">🧪</span><span
                  class="font-bold text-purple-800 dark:text-purple-300">Katalon Studio (Visual Testing)</span></div>
              <div class="text-xs text-gray-500 dark:text-gray-300 mb-1">All-in-one testing platform with AI-driven
                visual comparison</div>
              <ul class="text-sm text-gray-700 dark:text-gray-200 mb-1">
                <li><b>Best For:</b> Enterprise-scale UI testing with test cases, reports, analytics</li>
                <li><b>Strengths:</b> Smart image matching, DOM-based inspection, AI layout analysis</li>
                <li><b>Weaknesses:</b> Heavier setup, less suited for lightweight snapshot needs</li>
                <li><b>Good For Testing:</b> <span class="text-green-700">Full pages, themes, alerts, form validation,
                    layout bugs</span></li>
                <li><b>Limitations:</b> <span class="text-yellow-700">Not ideal for headless component testing (e.g.
                    Storybook-driven)</span></li>
              </ul>
            </div>
            <!-- Kobiton -->
            <div
              class="bg-white dark:bg-gray-900 dark:border-gray-600 dark:text-gray-100 rounded-xl p-5 shadow-lg border border-purple-100 dark:border-gray-600 backdrop-blur-md transition-transform duration-200 hover:scale-105 hover:shadow-2xl hover:border-purple-400 dark:hover:border-purple-500 w-full"
              style="box-shadow: 0 4px 24px 0 rgba(75,31,166,0.10);">
              <div class="flex items-center mb-1 dark:text-purple-200"><span class="text-2xl mr-2">🟡</span><span
                  class="font-bold text-purple-800 dark:text-purple-300">Kobiton</span></div>
              <div class="text-xs text-gray-500 dark:text-gray-300 mb-1">Real-device testing platform with visual
                inspection</div>
              <ul class="text-sm text-gray-700 dark:text-gray-200 mb-1">
                <li><b>Best For:</b> Mobile UI testing (iOS/Android) on physical devices</li>
                <li><b>Strengths:</b> Captures screenshots during manual/automated runs; AI compares visual differences
                  across devices</li>
                <li><b>Weaknesses:</b> Mobile-only; not suited for full web app testing alone</li>
                <li><b>Good For Testing:</b> <span class="text-green-700">Responsive layouts, mobile-specific UI bugs,
                    device rendering differences</span></li>
                <li><b>Limitations:</b> <span class="text-red-600">Desktop-only apps, dynamic JS content on non-mobile
                    viewports</span></li>
              </ul>
            </div>
            <!-- Chromatic -->
            <div
              class="bg-white dark:bg-gray-900 dark:border-gray-600 dark:text-gray-100 rounded-xl p-5 shadow-lg border border-purple-100 dark:border-gray-600 backdrop-blur-md transition-transform duration-200 hover:scale-105 hover:shadow-2xl hover:border-purple-400 dark:hover:border-purple-500 w-full"
              style="box-shadow: 0 4px 24px 0 rgba(75,31,166,0.10);">
              <div class="flex items-center mb-1 dark:text-purple-200"><span class="text-2xl mr-2">🧩</span><span
                  class="font-bold text-purple-800 dark:text-purple-300">Chromatic (for Storybook)</span></div>
              <div class="text-xs text-gray-500 dark:text-gray-300 mb-1">UI component visual testing & review for
                Storybook projects</div>
              <ul class="text-sm text-gray-700 dark:text-gray-200 mb-1">
                <li><b>Best For:</b> React/Vue/Angular components</li>
                <li><b>Strengths:</b> Snapshot each component in isolation, view diffs per commit, team review tools
                </li>
                <li><b>Weaknesses:</b> Only works if your UI is broken into components via Storybook</li>
                <li><b>Good For Testing:</b> <span class="text-green-700">Isolated UI states, themes, accessibility
                    styles, error/success states</span></li>
                <li><b>Limitations:</b> <span class="text-red-600">Canvas, page-level animation/layout shifts, lazy load
                    on scroll</span></li>
              </ul>
            </div>
            <!-- PhantomCSS -->
            <div
              class="bg-white dark:bg-gray-900 dark:border-gray-600 dark:text-gray-100 rounded-xl p-5 shadow-lg border border-purple-100 dark:border-gray-600 backdrop-blur-md transition-transform duration-200 hover:scale-105 hover:shadow-2xl hover:border-purple-400 dark:hover:border-purple-500 w-full"
              style="box-shadow: 0 4px 24px 0 rgba(75,31,166,0.10);">
              <div class="flex items-center mb-1 dark:text-purple-200"><span class="text-2xl mr-2">🎯</span><span
                  class="font-bold text-purple-800 dark:text-purple-300">PhantomCSS</span></div>
              <div class="text-xs text-gray-500 dark:text-gray-300 mb-1">Screenshot diff tool using PhantomJS/CasperJS
              </div>
              <ul class="text-sm text-gray-700 dark:text-gray-200 mb-1">
                <li><b>Best For:</b> Legacy testing environments, simple DOM UIs</li>
                <li><b>Strengths:</b> Headless browser testing, image comparisons</li>
                <li><b>Weaknesses:</b> Outdated (PhantomJS no longer maintained), limited modern JS support</li>
                <li><b>Good For Testing:</b> <span class="text-green-700">Static forms, headers, fixed-layout
                    differences</span></li>
                <li><b>Limitations:</b> <span class="text-red-600">Animations, responsive design, dynamic content</span>
                </li>
              </ul>
            </div>
            <!-- Galen Framework -->
            <div
              class="bg-white dark:bg-gray-900 dark:border-gray-600 dark:text-gray-100 rounded-xl p-5 shadow-lg border border-purple-100 dark:border-gray-600 backdrop-blur-md transition-transform duration-200 hover:scale-105 hover:shadow-2xl hover:border-purple-400 dark:hover:border-purple-500 w-full"
              style="box-shadow: 0 4px 24px 0 rgba(75,31,166,0.10);">
              <div class="flex items-center mb-1 dark:text-purple-200"><span class="text-2xl mr-2">⚙️</span><span
                  class="font-bold text-purple-800 dark:text-purple-300">Galen Framework</span></div>
              <div class="text-xs text-gray-500 dark:text-gray-300 mb-1">Layout-based visual regression using custom
                specs</div>
              <ul class="text-sm text-gray-700 dark:text-gray-200 mb-1">
                <li><b>Best For:</b> Testing layout rules across screen sizes</li>
                <li><b>Strengths:</b> Tests layout constraints (e.g., "button must be 10px from header"), not just
                  pixels</li>
                <li><b>Weaknesses:</b> Requires writing layout specs in DSL format; not drag-and-drop</li>
                <li><b>Good For Testing:</b> <span class="text-green-700">Grid layouts, responsive constraints, spacing
                    bugs</span></li>
                <li><b>Limitations:</b> <span class="text-yellow-700">Complex animations or theming not its focus</span>
                </li>
              </ul>
            </div>
            <!-- AyeSpy -->
            <div
              class="bg-white dark:bg-gray-900 dark:border-gray-600 dark:text-gray-100 rounded-xl p-5 shadow-lg border border-purple-100 dark:border-gray-600 backdrop-blur-md transition-transform duration-200 hover:scale-105 hover:shadow-2xl hover:border-purple-400 dark:hover:border-purple-500 w-full"
              style="box-shadow: 0 4px 24px 0 rgba(75,31,166,0.10);">
              <div class="flex items-center mb-1 dark:text-purple-200"><span class="text-2xl mr-2">🖼</span><span
                  class="font-bold text-purple-800 dark:text-purple-300">AyeSpy</span></div>
              <div class="text-xs text-gray-500 dark:text-gray-300 mb-1">Minimal CLI-based screenshot diff tool</div>
              <ul class="text-sm text-gray-700 dark:text-gray-200 mb-1">
                <li><b>Best For:</b> Simple, fast regression testing in CI/CD</li>
                <li><b>Strengths:</b> Threshold configuration, YAML setup, self-hosted reporting</li>
                <li><b>Weaknesses:</b> Basic UI; lacks AI or deep component integration</li>
                <li><b>Good For Testing:</b> <span class="text-green-700">Static diffs, hover/focus styles, minimal
                    layouts</span></li>
                <li><b>Limitations:</b> <span class="text-red-600">Animations, canvas/webGL, responsive behavior
                    testing</span></li>
              </ul>
            </div>
            <!-- SikuliX -->
            <div
              class="bg-white dark:bg-gray-900 dark:border-gray-600 dark:text-gray-100 rounded-xl p-5 shadow-lg border border-purple-100 dark:border-gray-600 backdrop-blur-md transition-transform duration-200 hover:scale-105 hover:shadow-2xl hover:border-purple-400 dark:hover:border-purple-500 w-full"
              style="box-shadow: 0 4px 24px 0 rgba(75,31,166,0.10);">
              <div class="flex items-center mb-1 dark:text-purple-200"><span class="text-2xl mr-2">🧿</span><span
                  class="font-bold text-purple-800 dark:text-purple-300">SikuliX</span></div>
              <div class="text-xs text-gray-500 dark:text-gray-300 mb-1">Image-recognition-based GUI automation (desktop
                & web)</div>
              <ul class="text-sm text-gray-700 dark:text-gray-200 mb-1">
                <li><b>Best For:</b> Testing UIs without DOM (e.g., games, Flash, legacy apps)</li>
                <li><b>Strengths:</b> Works off screenshots—can click/verify anything visible</li>
                <li><b>Weaknesses:</b> Slow, image-based—not DOM-aware or layout sensitive</li>
                <li><b>Good For Testing:</b> <span class="text-green-700">Canvas, non-HTML UIs, desktop apps</span></li>
                <li><b>Limitations:</b> <span class="text-yellow-700">Web layouts and styling logic mostly opaque</span>
                </li>
              </ul>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
  <script>
    (function () {
      // Utility: Debounce
      function debounce(fn, delay) {
        let t; return (...args) => { clearTimeout(t); t = setTimeout(() => fn(...args), delay); };
      }

      // Password toggle
      window.togglePassword = function () {
        const passwordInput = document.getElementById('password');
        const eyeIcon = document.getElementById('eyeIcon');
        if (passwordInput.type === 'password') {
          passwordInput.type = 'text';
          eyeIcon.classList.remove('fa-eye');
          eyeIcon.classList.add('fa-eye-slash');
        } else {
          passwordInput.type = 'password';
          eyeIcon.classList.remove('fa-eye-slash');
          eyeIcon.classList.add('fa-eye');
        }
      };

      document.addEventListener('DOMContentLoaded', function () {
        // --- System Info Side Panel ---
        const openSidePanelBtn = document.getElementById('open-side-panel-btn');
        const sidePanel = document.getElementById('side-panel');
        const sidePanelClose = document.getElementById('side-panel-close');
        const overlay = document.getElementById('panel-overlay');
        function updateSystemInfo() {
          const sidePanelContent = document.getElementById('side-panel-content');
          // Gather info
          const getOS = () => {
            const ua = window.navigator.userAgent;
            if (ua.indexOf('Win') !== -1) return 'Windows';
            if (ua.indexOf('Mac') !== -1) return 'MacOS';
            if (ua.indexOf('Linux') !== -1) return 'Linux';
            if (ua.indexOf('Android') !== -1) return 'Android';
            if (ua.indexOf('like Mac') !== -1) return 'iOS';
            return 'Unknown';
          };
          const getBrowserAndVersion = () => {
            const ua = navigator.userAgent;
            let browser = 'Unknown', version = '';
            if (/Edg\/(\d+\.\d+)/.test(ua)) {
              browser = 'Edge'; version = ua.match(/Edg\/(\d+\.\d+)/)[1];
            } else if (/OPR\/(\d+\.\d+)/.test(ua)) {
              browser = 'Opera'; version = ua.match(/OPR\/(\d+\.\d+)/)[1];
            } else if (/Chrome\/(\d+\.\d+)/.test(ua)) {
              browser = 'Chrome'; version = ua.match(/Chrome\/(\d+\.\d+)/)[1];
            } else if (/Firefox\/(\d+\.\d+)/.test(ua)) {
              browser = 'Firefox'; version = ua.match(/Firefox\/(\d+\.\d+)/)[1];
            } else if (/Version\/(\d+\.\d+).*Safari/.test(ua)) {
              browser = 'Safari'; version = ua.match(/Version\/(\d+\.\d+)/)[1];
            }
            return browser + (version ? ' ' + version : '');
          };
          // Info values
          let os = getOS();
          let browser = getBrowserAndVersion();
          let screenRes = `${window.screen.width} x ${window.screen.height}`;
          let availScreenRes = `${window.screen.availWidth} x ${window.screen.availHeight}`;
          let viewportRes = `${window.innerWidth} x ${window.innerHeight}`;
          let outerWindowRes = `${window.outerWidth} x ${window.outerHeight}`;
          let dpr = window.devicePixelRatio;
          let lang = navigator.language;
          let platform = navigator.platform;
          let userAgent = navigator.userAgent;
          let osVersion = 'N/A';
          let networkSpeed = 'N/A';
          let networkType = 'N/A';
          let chargingStatus = 'N/A';
          let batteryLevel = 'N/A';
          let ip = 'N/A';
          let country = 'N/A';
          let screenshotDims = `${window.innerWidth} x ${window.innerHeight}`;
          let connectionType = 'N/A';
          let isMetered = 'N/A';
          let isOnline = navigator.onLine ? 'Online' : 'Offline';
          let deviceMemory = 'N/A';
          let cpuCores = 'N/A';
          let touchSupport = 'N/A';
          let cookiesEnabled = navigator.cookieEnabled ? 'Yes' : 'No';
          let doNotTrack = (navigator.doNotTrack === '1' || navigator.doNotTrack === 'yes') ? 'Yes' : 'No';
          let referrer = document.referrer || 'N/A';
          if (/Mac OS X ([\d_]+)/.test(userAgent)) {
            osVersion = 'MacOS ' + userAgent.match(/Mac OS X ([\d_]+)/)[1].replace(/_/g, '.');
          } else if (/Windows NT ([\d.]+)/.test(userAgent)) {
            osVersion = 'Windows NT ' + userAgent.match(/Windows NT ([\d.]+)/)[1];
          } else if (/Android ([\d.]+)/.test(userAgent)) {
            osVersion = 'Android ' + userAgent.match(/Android ([\d.]+)/)[1];
          } else if (/iPhone OS ([\d_]+)/.test(userAgent)) {
            osVersion = 'iOS ' + userAgent.match(/iPhone OS ([\d_]+)/)[1].replace(/_/g, '.');
          }
          if (navigator.connection) {
            if (typeof navigator.connection.downlink !== 'undefined') {
              networkSpeed = navigator.connection.downlink + ' Mbps';
            }
            if (typeof navigator.connection.effectiveType !== 'undefined') {
              networkType = navigator.connection.effectiveType;
            }
            if (typeof navigator.connection.type !== 'undefined') {
              connectionType = navigator.connection.type;
            }
            if (typeof navigator.connection.metered !== 'undefined') {
              isMetered = navigator.connection.metered ? 'Yes' : 'No';
            }
          }
          if (navigator.deviceMemory) {
            deviceMemory = navigator.deviceMemory + ' GB';
          }
          if (navigator.hardwareConcurrency) {
            cpuCores = navigator.hardwareConcurrency;
          }
          if (typeof navigator.maxTouchPoints !== 'undefined') {
            touchSupport = navigator.maxTouchPoints > 0 ? navigator.maxTouchPoints : 'No';
          }
          // Async battery and IP
          if (navigator.getBattery) {
            navigator.getBattery().then(function (battery) {
              chargingStatus = battery.charging ? 'Charging' : 'Not Charging';
              batteryLevel = Math.round(battery.level * 100) + '%';
              render();
            }).catch(function () {
              chargingStatus = 'N/A';
              batteryLevel = 'N/A';
              render();
            });
          }
          fetch('https://ipapi.co/json/')
            .then(res => res.json())
            .then(data => {
              ip = data.ip || 'N/A';
              country = data.country_name || 'N/A';
              render();
            }).catch(() => {
              ip = 'N/A';
              country = 'N/A';
              render();
            });
          function render(activeTabId = 'device') {
            const tabs = [
              { id: 'device', label: 'Device' },
              { id: 'display', label: 'Display' },
              { id: 'network', label: 'Network' }
            ];
            const tabContent = {
              device: `
            <div class="sysinfo-row flex justify-between items-center text-sm mb-2"><span class="font-medium">OS Version:</span> <span class="sysval">${osVersion}</span></div><hr class="sysinfo-hr">
            <div class="sysinfo-row flex justify-between items-center text-sm mb-2"><span class="font-medium">Platform:</span> <span class="sysval">${platform}</span></div><hr class="sysinfo-hr">
            <div class="sysinfo-row flex justify-between items-center text-sm mb-2"><span class="font-medium">Language:</span> <span class="sysval">${lang}</span></div><hr class="sysinfo-hr">
            <div class="sysinfo-row flex justify-between items-center text-sm mb-2"><span class="font-medium">Device Memory:</span> <span class="sysval">${deviceMemory}</span></div><hr class="sysinfo-hr">
            <div class="sysinfo-row flex justify-between items-center text-sm mb-2"><span class="font-medium">CPU Cores:</span> <span class="sysval">${cpuCores}</span></div><hr class="sysinfo-hr">
            <div class="sysinfo-row flex justify-between items-center text-sm mb-2"><span class="font-medium">Touch Support:</span> <span class="sysval">${touchSupport}</span></div><hr class="sysinfo-hr">
            <div class="sysinfo-row flex justify-between items-center text-sm mb-2"><span class="font-medium">Battery Status:</span> <span class="sysval">${batteryLevel} ${chargingStatus}</span></div><hr class="sysinfo-hr">
            <div class="sysinfo-row flex justify-between items-center text-sm mb-2"><span class="font-medium">Browser:</span> <span class="sysval">${browser}</span></div><hr class="sysinfo-hr">
            <div class="sysinfo-row flex justify-between items-center text-sm mb-2"><span class="font-medium">User Agent:</span> <span class="sysval break-all text-xs">${userAgent}</span></div><hr class="sysinfo-hr">
            <div class="sysinfo-row flex justify-between items-center text-sm mb-2"><span class="font-medium">Cookies Enabled:</span> <span class="sysval">${cookiesEnabled}</span></div><hr class="sysinfo-hr">
            <div class="sysinfo-row flex justify-between items-center text-sm mb-2"><span class="font-medium">Do Not Track:</span> <span class="sysval">${doNotTrack}</span></div><hr class="sysinfo-hr">
            <div class="sysinfo-row flex justify-between items-center text-sm mb-2"><span class="font-medium">Referrer:</span> <span class="sysval break-all">${referrer}</span></div>
          `,
              display: `
            <div class="sysinfo-row flex justify-between items-center text-sm mb-2"><span class="font-medium">Screen Resolution:</span> <span class="sysval">${screenRes}</span></div><hr class="sysinfo-hr">
            <div class="sysinfo-row flex justify-between items-center text-sm mb-2"><span class="font-medium">Available Screen:</span> <span class="sysval">${availScreenRes}</span></div><hr class="sysinfo-hr">
            <div class="sysinfo-row flex justify-between items-center text-sm mb-2"><span class="font-medium">Window Size (outer):</span> <span class="sysval">${outerWindowRes}</span></div><hr class="sysinfo-hr">
            <div class="sysinfo-row flex justify-between items-center text-sm mb-2"><span class="font-medium">Viewport Size (inner):</span> <span class="sysval">${viewportRes}</span></div><hr class="sysinfo-hr">
            <div class="sysinfo-row flex justify-between items-center text-sm mb-2"><span class="font-medium">Screenshot Dimensions:</span> <span class="sysval">${screenshotDims}</span></div><hr class="sysinfo-hr">
            <div class="sysinfo-row flex justify-between items-center text-sm mb-2"><span class="font-medium">Device Pixel Ratio:</span> <span class="sysval">${dpr}</span></div>
          `,
              network: `
            <div class="sysinfo-row flex justify-between items-center text-sm mb-2"><span class="font-medium">Network Speed:</span> <span class="sysval">${networkSpeed}</span></div><hr class="sysinfo-hr">
            <div class="sysinfo-row flex justify-between items-center text-sm mb-2"><span class="font-medium">Network Type:</span> <span class="sysval">${networkType}</span></div><hr class="sysinfo-hr">
            <div class="sysinfo-row flex justify-between items-center text-sm mb-2"><span class="font-medium">Connection Type:</span> <span class="sysval">${connectionType}</span></div><hr class="sysinfo-hr">
            <div class="sysinfo-row flex justify-between items-center text-sm mb-2"><span class="font-medium">Metered Connection:</span> <span class="sysval">${isMetered}</span></div><hr class="sysinfo-hr">
            <div class="sysinfo-row flex justify-between items-center text-sm mb-2"><span class="font-medium">Online Status:</span> <span class="sysval">${isOnline}</span></div><hr class="sysinfo-hr">
            <div class="sysinfo-row flex justify-between items-center text-sm mb-2"><span class="font-medium">Country:</span> <span class="sysval">${country}</span></div><hr class="sysinfo-hr">
            <div class="sysinfo-row flex justify-between items-center text-sm mb-2"><span class="font-medium">IP Address:</span> <span class="sysval">${ip}</span></div>
          `
            };
            const tabBar = `
          <div id="sysinfo-tabs" class="flex gap-1 mb-3">
            ${tabs.map(tab => `<button class="sysinfo-tab flex-1 py-1.5 text-xs rounded-t-md font-semibold tab-inactive" data-tab="${tab.id}">${tab.label}</button>`).join('')}
          </div>
        `;
            sidePanelContent.innerHTML = `
          ${tabBar}
          <div id="sysinfo-tab-content" class="min-h-[90px]">
            ${tabs.map(tab => `<div id="sysinfo-content-${tab.id}" class="${tab.id === activeTabId ? '' : 'hidden'}">${tabContent[tab.id]}</div>`).join('')}
          </div>
        `;
            // Tab switching logic
            const tabBtns = sidePanelContent.querySelectorAll('.sysinfo-tab');
            const tabDivs = sidePanelContent.querySelectorAll('#sysinfo-tab-content > div');
            tabBtns.forEach(btn => {
              btn.onclick = function () {
                tabBtns.forEach(b => b.classList.remove('tab-active'));
                tabDivs.forEach(d => d.classList.add('hidden'));
                btn.classList.add('tab-active');
                const tabId = btn.getAttribute('data-tab');
                const contentDiv = sidePanelContent.querySelector(`#sysinfo-content-${tabId}`);
                if (contentDiv) contentDiv.classList.remove('hidden');
              };
            });
            // Set default tab
            if (tabBtns.length) tabBtns[0].classList.add('tab-active');
            if (tabDivs.length) tabDivs[0].classList.remove('hidden');
          }
          render();
        }
        function showOverlay() {
          overlay.classList.remove('hidden');
          overlay.classList.add('opacity-100');
        }
        function hideOverlay() {
          overlay.classList.add('hidden');
          overlay.classList.remove('opacity-100');
        }
        openSidePanelBtn.onclick = function () {
          sidePanel.classList.remove('side-panel-closed');
          sidePanel.classList.add('side-panel-open');
          sidePanel.style.left = '0';
          updateSystemInfo();
          showOverlay();
        };
        sidePanelClose.onclick = function () {
          sidePanel.classList.remove('side-panel-open');
          sidePanel.classList.add('side-panel-closed');
          sidePanel.style.left = '-400px';
          hideOverlay();
        };
        sidePanel.classList.add('side-panel-closed');

        // --- Image Slider ---
        const sliderDots = document.getElementById('slider-dots');
        const sliderImg = document.getElementById('slider-img');
        const images = [
          'https://images.unsplash.com/photo-1513258496099-48168024aec0?auto=format&fit=crop&w=540&q=80',
          'https://images.unsplash.com/photo-1521737852567-6949f3f9f2b5?auto=format&fit=crop&w=540&q=80',
          'https://images.unsplash.com/photo-1519389950473-47ba0277781c?auto=format&fit=crop&w=540&q=80'
        ];
        function getUrlParam(name) {
          return new URLSearchParams(window.location.search).get(name);
        }
        function showSlider(enabled) {
          if (enabled) {
            sliderDots.style.display = '';
            let idx = 0;
            function renderDots() {
              sliderDots.innerHTML = '';
              images.forEach((_, i) => {
                const dot = document.createElement('span');
                dot.className = 'w-3 h-3 rounded-full border-2 border-white bg-white opacity-60 mx-1 cursor-pointer' + (i === idx ? ' opacity-100 bg-purple-500' : '');
                dot.onclick = () => {
                  idx = i;
                  sliderImg.src = images[idx];
                  renderDots();
                };
                sliderDots.appendChild(dot);
              });
            }
            renderDots();
            if (window.sliderInterval) clearInterval(window.sliderInterval);
            window.sliderInterval = setInterval(() => {
              idx = (idx + 1) % images.length;
              sliderImg.src = images[idx];
              renderDots();
            }, 4000);
          } else {
            sliderImg.src = images[0];
            sliderDots.style.display = 'none';
            if (window.sliderInterval) clearInterval(window.sliderInterval);
          }
        }
        showSlider(getUrlParam('slider') === 'on');
        window.addEventListener('popstate', () => {
          showSlider(getUrlParam('slider') === 'on');
        });

        // --- Visual Regression Parameters Panel Logic ---
        const helpIcon = document.getElementById('help-icon');
        const helpPanel = document.getElementById('help-panel');
        const helpClose = document.getElementById('help-close');
        const paramForm = document.getElementById('param-form');
        const paramTabs = document.getElementById('param-tabs');
        const paramApply = document.getElementById('param-apply');
        const paramReset = document.getElementById('param-reset');
        const PARAM_SECTIONS = [
          { title: 'Typography', keys: ['font', 'fontSize', 'fontColour', 'fontBold', 'fallbackFont', 'subheadingStyle'] },
          { title: 'Layout', keys: ['offsetVertical', 'offsetHorizontal', 'border', 'shadow', 'rtl', 'grid', 'progressiveBlur', 'ruler'] },
          { title: 'Effects', keys: ['invert', 'anim', 'banner', 'toast', 'popup', 'cookie', 'floatingBox'] },
          { title: 'Form & UX', keys: ['hideForm', 'buttonStyle', 'hideSocial', 'timer', 'disableLogin', 'inputError', 'hideFooter'] },
          { title: 'Image', keys: ['blur', 'grayscale', 'overlay', 'highContrast', 'hideImage', 'svgicons', 'randomPixel', 'imageMode', 'distortedImage'] }
        ];
        const PARAMS = [
          { key: 'font', label: 'Serif Font', value: 'serif', type: 'radio', group: 'font' },
          { key: 'font', label: 'Sans Font', value: 'sans', type: 'radio', group: 'font', default: true },
          { key: 'font', label: 'Mono Font', value: 'mono', type: 'radio', group: 'font' },
          { key: 'font', label: 'Raleway Font', value: 'raleway', type: 'radio', group: 'font' },
          { key: 'fontSize', label: 'Large Font', value: 'large', type: 'radio', group: 'fontSize' },
          { key: 'fontSize', label: 'Normal Font', value: 'normal', type: 'radio', group: 'fontSize', default: true },
          { key: 'fontSize', label: 'Small Font', value: 'small', type: 'radio', group: 'fontSize' },
          { key: 'fontBold', label: 'Bold', value: 'on', type: 'checkbox' },
          { key: 'fontColour', label: 'Font Colour', value: '', type: 'color' },
          { key: 'subheadingStyle', label: 'Default Subheading', value: 'default', type: 'radio', group: 'subheadingStyle', default: true },
          { key: 'subheadingStyle', label: 'Long Subheading', value: 'long', type: 'radio', group: 'subheadingStyle' },
          { key: 'subheadingStyle', label: 'Subheading with Ellipsis', value: 'ellipsis', type: 'radio', group: 'subheadingStyle' },
          { key: 'offsetVertical', label: 'Offset Vertical', value: 'on', type: 'checkbox' },
          { key: 'offsetHorizontal', label: 'Offset Horizontal', value: 'on', type: 'checkbox' },
          { key: 'border', label: 'Border on Card', value: 'on', type: 'checkbox' },
          { key: 'shadow', label: 'No Shadow', value: 'off', type: 'checkbox' },
          { key: 'anim', label: 'Animate Elements', value: 'on', type: 'checkbox' },
          { key: 'rtl', label: 'Right-to-Left Layout', value: 'on', type: 'checkbox' },
          { key: 'invert', label: 'Invert Colors', value: 'on', type: 'checkbox' },
          { key: 'hideFooter', label: 'Hide Footer', value: 'on', type: 'checkbox' },
          { key: 'grid', label: 'Show Grid', value: 'on', type: 'checkbox' },
          { key: 'ruler', label: 'Show Ruler', value: 'on', type: 'checkbox' },
          { key: 'banner', label: 'Show Banner', value: 'on', type: 'checkbox' },
          { key: 'cookie', label: 'Show Cookie Banner', value: 'on', type: 'checkbox' },
          { key: 'popup', label: 'Show Popup', value: 'on', type: 'checkbox' },
          { key: 'toast', label: 'Show Toast', value: 'on', type: 'checkbox' },
          { key: 'blur', label: 'Blur Image', value: 'on', type: 'checkbox' },
          { key: 'grayscale', label: 'Grayscale Image', value: 'on', type: 'checkbox' },
          { key: 'overlay', label: 'Overlay', value: 'on', type: 'checkbox' },
          { key: 'highContrast', label: 'High Contrast', value: 'on', type: 'checkbox' },
          { key: 'hideImage', label: 'Hide Image', value: 'on', type: 'checkbox' },
          { key: 'imageMode', label: 'Default Image', value: 'default', type: 'radio', group: 'imageMode', default: true },
          { key: 'imageMode', label: 'Image Slider', value: 'slider', type: 'radio', group: 'imageMode' },
          { key: 'imageMode', label: 'Canvas/WebGL', value: 'canvas', type: 'radio', group: 'imageMode' },
          { key: 'imageMode', label: 'Bento Grid', value: 'bentoGrid', type: 'radio', group: 'imageMode' },
          { key: 'imageMode', label: 'Broken Image', value: 'brokenImage', type: 'radio', group: 'imageMode' },
          { key: 'imageMode', label: 'Random Pixel', value: 'randomPixel', type: 'radio', group: 'imageMode' },
          { key: 'distortedImage', label: 'Distorted Image', value: 'on', type: 'checkbox' },
          { key: 'hideForm', label: 'Hide Form', value: 'on', type: 'checkbox' },
          { key: 'buttonStyle', label: 'Alternate Button Style', value: 'alt', type: 'checkbox' },
          { key: 'hideSocial', label: 'Hide One Social Button', value: 'on', type: 'checkbox' },
          { key: 'timer', label: 'Show Countdown', value: 'on', type: 'checkbox' },
          { key: 'floatingBox', label: 'Show Floating Box', value: 'on', type: 'checkbox' },
          { key: 'inputError', label: 'Show Input Error', value: 'on', type: 'checkbox' },
          { key: 'svgicons', label: 'Use SVG icons', value: 'on', type: 'checkbox' },
          { key: 'progressiveBlur', label: 'Progressive Blur', value: 'on', type: 'checkbox' },
        ];
        let activeParamTab = 0;
        function getDefaultParams() {
          const defaults = {};
          PARAMS.forEach(p => {
            if (p.type === 'radio' && p.default) defaults[p.key] = p.value;
            if (p.type === 'checkbox' && p.default) defaults[p.key] = p.value;
            if (p.type === 'color' && p.default) defaults[p.key] = p.default;
          });
          // Set shadow to ON by default
          defaults.shadow = 'on';
          // Set fontSize to normal by default
          if (!defaults.fontSize) defaults.fontSize = 'normal';
          return defaults;
        }
        function getCurrentParams() {
          const params = new URLSearchParams(window.location.search);
          return Object.fromEntries(params.entries());
        }
        // Track open accordion index
        let openAccordionIdx = 0;
        function renderParamForm() {
          paramForm.innerHTML = '';
          const current = getCurrentParams();
          PARAM_SECTIONS.forEach((section, i) => {
            // Accordion header
            const accBtn = document.createElement('button');
            accBtn.type = 'button';
            accBtn.className = 'accordion-header w-full flex justify-between items-center px-4 py-2 font-semibold text-purple-700 bg-purple-100 rounded-t-md focus:outline-none mb-0 mt-2';
            accBtn.setAttribute('aria-expanded', i === openAccordionIdx ? 'true' : 'false');
            accBtn.setAttribute('data-accidx', i);
            accBtn.innerHTML = `<span>${section.title}</span><span class="accordion-arrow">${i === openAccordionIdx ? '&#9650;' : '&#9660;'}</span>`;
            // Accordion panel
            const accPanel = document.createElement('div');
            accPanel.className = 'accordion-panel px-2 pb-3';
            accPanel.style.display = i === openAccordionIdx ? '' : 'none';
            // Section form grid
            const formGrid = document.createElement('div');
            formGrid.className = 'grid grid-cols-2 gap-2';
            section.keys.forEach(key => {
              PARAMS.filter(p => p.key === key).forEach(param => {
                let checked = false;
                if (param.type === 'checkbox') checked = current[param.key] === param.value;
                if (param.type === 'radio') {
                  if (current[param.key]) checked = current[param.key] === param.value;
                  else if (param.default) checked = true;
                }
                if (param.type === 'color') checked = !!current[param.key];
                if (param.type === 'number') checked = !!current[param.key];
                const label = document.createElement('label');
                label.className = 'flex items-center gap-2 mb-1 cursor-pointer px-2 py-1 transition';
                if (checked) label.classList.add('font-semibold');
                if (param.type === 'checkbox') {
                  const input = document.createElement('input');
                  input.type = 'checkbox';
                  input.name = param.key;
                  input.value = param.value;
                  input.checked = checked;
                  input.className = 'accent-purple-500';
                  input.onchange = function () {
                    const params = new URLSearchParams(window.location.search);
                    if (input.checked) params.set(input.name, input.value);
                    else params.delete(input.name);
                    window.history.replaceState({}, '', `${window.location.pathname}?${params}`);
                    applyVisualParams();
                    renderParamForm();
                    setTimeout(applyVisualParams, 10);
                  };
                  label.appendChild(input);
                  label.appendChild(document.createTextNode(param.label));
                  formGrid.appendChild(label);
                } else if (param.type === 'radio') {
                  const input = document.createElement('input');
                  input.type = 'radio';
                  input.name = param.group;
                  input.value = param.value;
                  input.checked = checked;
                  input.className = 'accent-purple-500';
                  input.onchange = function () {
                    const params = new URLSearchParams(window.location.search);
                    params.set(param.group, input.value);
                    window.history.replaceState({}, '', `${window.location.pathname}?${params}`);
                    applyVisualParams();
                    renderParamForm();
                  };
                  label.appendChild(input);
                  label.appendChild(document.createTextNode(param.label));
                  if (param.default) {
                    const defaultSpan = document.createElement('span');
                    defaultSpan.className = 'ml-2 text-xs text-gray-400 font-normal';
                    defaultSpan.innerText = '(default)';
                    label.appendChild(defaultSpan);
                  }
                  formGrid.appendChild(label);
                } else if (param.type === 'color') {
                  const input = document.createElement('input');
                  input.type = 'color';
                  input.name = param.key;
                  input.value = current[param.key] || '#2d2d2d';
                  input.className = 'w-6 h-6 p-0 border-0';
                  input.oninput = debounce(function () {
                    const params = new URLSearchParams(window.location.search);
                    params.set(input.name, input.value);
                    window.history.replaceState({}, '', `${window.location.pathname}?${params}`);
                    applyVisualParams();
                  }, 200);
                  label.appendChild(document.createTextNode(param.label));
                  label.appendChild(input);
                  formGrid.appendChild(label);
                }
              });
            });
            accPanel.appendChild(formGrid);
            paramForm.appendChild(accBtn);
            paramForm.appendChild(accPanel);
          });
          // Accordion toggle logic
          const accHeaders = paramForm.querySelectorAll('.accordion-header');
          const accPanels = paramForm.querySelectorAll('.accordion-panel');
          accHeaders.forEach((btn, idx) => {
            btn.onclick = function () {
              openAccordionIdx = idx;
              accHeaders.forEach((b, i) => {
                b.setAttribute('aria-expanded', i === idx ? 'true' : 'false');
                b.querySelector('.accordion-arrow').innerHTML = i === idx ? '&#9650;' : '&#9660;';
                accPanels[i].style.display = i === idx ? '' : 'none';
              });
            };
          });
        }
        function showToast() {
          let toast = document.getElementById('toast');
          if (!toast) {
            toast = document.createElement('div');
            toast.id = 'toast';
            toast.className = 'fixed top-8 left-1/2 transform -translate-x-1/2 z-50 flex flex-col items-center space-y-2';
            document.body.appendChild(toast);
          }
          const types = [
            { cls: 'bg-green-500', txt: 'Success!', icon: 'fa-check-circle' },
            { cls: 'bg-red-500', txt: 'Error!', icon: 'fa-times-circle' },
            { cls: 'bg-yellow-400 text-black', txt: 'Warning!', icon: 'fa-exclamation-triangle' },
            { cls: 'bg-blue-500 text-white', txt: 'Info!', icon: 'fa-info-circle' },
            { cls: 'bg-gray-700', txt: 'Failure!', icon: 'fa-bug' }
          ];
          const t = types[Math.floor(Math.random() * types.length)];
          const el = document.createElement('div');
          el.className = `flex items-center gap-2 mb-2 px-4 py-2 rounded shadow-lg text-white font-bold ${t.cls} animate-fadeIn`;
          el.innerHTML = `<i class=\"fa-solid ${t.icon}\"></i> ${t.txt}`;
          toast.appendChild(el);
          setTimeout(() => { el.classList.add('opacity-0'); setTimeout(() => el.remove(), 500); }, 10000);
        }
        function showCookieBanner() {
          if (document.getElementById('cookie-banner')) return;
          const banner = document.createElement('div');
          banner.id = 'cookie-banner';
          banner.className = 'fixed left-1/2 bottom-8 bg-yellow-100 text-gray-900 shadow-xl px-8 py-6 flex items-start justify-between z-[1000] text-base rounded-xl border-2 border-yellow-400 min-w-[320px] max-w-[600px] -translate-x-1/2';
          banner.innerHTML = `<div class="flex-1 min-w-0">We use essential cookies to make our site work. With your consent, we may also use non-essential cookies to improve user experience and analyze website traffic. By clicking \"Accept\", you agree to our website's cookie use as described in our <a href="#" class="text-yellow-700 underline font-semibold">Cookie Policy</a>. You can change your cookie settings at any time by clicking \"Preferences.\"</div><div class="flex flex-col gap-2 min-w-[180px] ml-4"><button class="cookie-btn-prefs bg-white border-2 border-yellow-400 rounded-md px-4 py-2 font-bold text-yellow-700 hover:bg-yellow-200">Preferences</button><button class="cookie-btn-decline bg-yellow-50 border-2 border-yellow-500 rounded-md px-4 py-2 font-bold text-yellow-700 hover:bg-yellow-200">Decline</button><button class="cookie-btn-accept bg-yellow-400 border-2 border-yellow-500 rounded-md px-4 py-2 font-bold text-white hover:bg-yellow-500">Accept</button></div>`;
          document.body.appendChild(banner);
          banner.querySelector('.cookie-btn-accept').onclick = function () { banner.remove(); };
          banner.querySelector('.cookie-btn-decline').onclick = function () { banner.remove(); };
          banner.querySelector('.cookie-btn-prefs').onclick = function () { alert('Cookie preferences dialog would open.'); };
        }
        function showPopup() {
          if (document.getElementById('popup-modal')) return;
          const popup = document.createElement('div');
          popup.id = 'popup-modal';
          popup.className = 'fixed inset-0 flex items-center justify-center z-[3000] bg-black bg-opacity-40';
          popup.innerHTML = `
        <div class="bg-white dark:bg-gray-900 p-8 rounded-2xl shadow-2xl w-[60vw] max-w-[400px] text-center relative flex flex-col items-center border border-gray-200 dark:border-gray-700">
          <button id="popup-close" class="absolute top-3 right-4 text-2xl text-purple-500 hover:text-purple-700 transition">&times;</button>
          <div class="text-2xl font-bold text-gray-800 dark:text-gray-100 mb-2 flex items-center gap-2"><i class="fa-solid fa-circle-info text-purple-500"></i> Visual Regression Modal</div>
          <div class="mb-4 text-gray-600 dark:text-gray-300">This is a realistic popup/modal. You triggered this by adding <b>popup=on</b> to the URL or toggling Visual Regression Parameters.<br><br>Popups are useful for onboarding, warnings, confirmations, and more. You can style and animate them as needed.</div>
          <button id="popup-action" class="mt-2 px-5 py-2 bg-purple-500 text-white rounded-lg font-semibold shadow hover:bg-purple-600 transition">Got it!</button>
        </div>
      `;
          document.body.appendChild(popup);
          popup.querySelector('#popup-close').onclick = function () { popup.remove(); };
          popup.querySelector('#popup-action').onclick = function () { popup.remove(); };
        }
        function showBanner() {
          let banner = document.getElementById('scrolling-banner');
          if (!banner) {
            banner = document.createElement('div');
            banner.id = 'scrolling-banner';
            banner.className = 'fixed top-0 left-0 w-full bg-gradient-to-r from-purple-500 to-pink-500 text-white text-center py-2 z-50 animate-marquee';
            banner.innerHTML = '<span class="font-bold">🚀 Visual Regression Testing Mode Active — Dynamic UI changes enabled for testing — Try different parameters for font, color, layout, and image — Test accessibility and responsiveness — Simulate visual bugs and edge cases — Easily reset or combine features for robust regression testing</span>';
            document.body.appendChild(banner);
          }
          banner.style.display = '';
        }
        function showRuler() {
          let ruler = document.getElementById('ruler-overlay');
          if (!ruler) {
            ruler = document.createElement('div');
            ruler.id = 'ruler-overlay';
            ruler.className = 'pointer-events-none fixed inset-0 z-50';
            // Top and left rulers start at 0, increment by 1, lines at every 0.25, labels at major lines
            const topTicks = 7; // 0 to 6
            const leftTicks = 5; // 0 to 4
            // Top labels and major vertical lines
            let topRuler = '';
            for (let i = 0; i < topTicks; i++) {
              const left = `calc(32px + ${(i / (topTicks - 1)) * 100}% )`;
              topRuler += `<div style=\"position:absolute;left:${left};top:0;width:32px;height:24px;display:flex;align-items:center;justify-content:center;font-size:16px;color:#f00;font-weight:bold;transform:translateX(-50%);\">${i}</div>`;
            }
            // Left labels and major horizontal lines
            let leftRuler = '';
            for (let i = 0; i < leftTicks; i++) {
              const top = `calc(24px + ${(i / (leftTicks - 1)) * 100}% )`;
              leftRuler += `<div style=\"position:absolute;left:0;top:${top};width:32px;height:24px;display:flex;align-items:center;justify-content:center;font-size:16px;color:#f00;font-weight:bold;transform:translateY(-50%);\">${i}</div>`;
            }
            // Draw vertical lines (major and minor)
            let lines = '';
            for (let i = 0; i < topTicks; i++) {
              const left = `calc(32px + ${(i / (topTicks - 1)) * 100}% )`;
              lines += `<div style=\"position:absolute;top:24px;left:${left};width:2px;height:calc(100% - 24px);background:#f00;opacity:0.7;\"></div>`;
              // Minor lines between majors
              if (i < topTicks - 1) {
                for (let j = 1; j < 4; j++) {
                  const minorLeft = `calc(32px + ${((i + j / 4) / (topTicks - 1)) * 100}% )`;
                  lines += `<div style=\"position:absolute;top:24px;left:${minorLeft};width:1px;height:calc(100% - 24px);background:#888;opacity:0.3;\"></div>`;
                }
              }
            }
            // Draw horizontal lines (major and minor)
            for (let i = 0; i < leftTicks; i++) {
              const top = `calc(24px + ${(i / (leftTicks - 1)) * 100}% )`;
              lines += `<div style=\"position:absolute;left:32px;top:${top};height:2px;width:calc(100% - 32px);background:#f00;opacity:0.7;\"></div>`;
              // Minor lines between majors
              if (i < leftTicks - 1) {
                for (let j = 1; j < 4; j++) {
                  const minorTop = `calc(24px + ${((i + j / 4) / (leftTicks - 1)) * 100}% )`;
                  lines += `<div style=\"position:absolute;left:32px;top:${minorTop};height:1px;width:calc(100% - 32px);background:#888;opacity:0.3;\"></div>`;
                }
              }
            }
            // 0,0 label in the corner
            let corner = '<div style="position:absolute;left:0;top:0;width:32px;height:24px;display:flex;align-items:center;justify-content:center;font-size:16px;color:#f00;font-weight:bold;">0,0</div>';
            ruler.innerHTML = `${topRuler}${leftRuler}${lines}${corner}`;
            document.body.appendChild(ruler);
          }
          ruler.style.display = '';
        }
        function hideRuler() {
          const ruler = document.getElementById('ruler-overlay');
          if (ruler) ruler.style.display = 'none';
        }
        function hideBanner() {
          const banner = document.getElementById('scrolling-banner');
          if (banner) banner.style.display = 'none';
        }
        function hidePopup() {
          const popup = document.getElementById('popup-modal');
          if (popup) popup.remove();
        }
        function hideCookieBanner() {
          const banner = document.getElementById('cookie-banner');
          if (banner) banner.remove();
        }
        const loginRight = document.getElementById('login-right');

        function applyVisualParams() {
          const params = getCurrentParams();
          const card = document.getElementById('main-card');
          const footer = document.getElementById('footer');
          const settingsIcon = document.getElementById('settings-icon');
          const sysHeader = document.getElementById('side-panel-header');
          document.querySelectorAll('.fancy-btn').forEach(btn => btn.classList.remove('animate-bounce'));
          if (params.anim) {
            card && card.classList.add('animate-fadeIn'); setTimeout(() => card && card.classList.remove('animate-fadeIn'), 800);
            settingsIcon && settingsIcon.classList.add('animate-spin');
            sysHeader && sysHeader.classList.add('animate-pulse');
            document.querySelectorAll('.fancy-btn').forEach(btn => btn.classList.add('animate-bounce'));
          } else {
            settingsIcon && settingsIcon.classList.remove('animate-spin');
            sysHeader && sysHeader.classList.remove('animate-pulse');
          }
          card && (card.style.marginTop = params.offsetVertical ? '5px' : '');
          card && (card.style.marginLeft = params.offsetHorizontal ? '5px' : '');
          card && (params.border ? card.classList.add('border-2', 'border-purple-400') : card.classList.remove('border-2', 'border-purple-400'));
          footer && (footer.style.visibility = params.hideFooter ? 'hidden' : '');
          let floatBox = document.getElementById('floating-box');
          if (params.floatingBox) {
            if (!floatBox) {
              floatBox = document.createElement('div');
              floatBox.id = 'floating-box';
              floatBox.className = 'fixed top-20 right-20 bg-purple-100 border-2 border-purple-400 rounded-xl shadow-lg px-6 py-4 z-50 animate-bounce';
              floatBox.innerHTML = '<b>Floating Box</b><br>This is a floating box.';
              document.body.appendChild(floatBox);
            }
            floatBox.style.display = '';
          } else if (floatBox) { floatBox.style.display = 'none'; }
          let timer = document.getElementById('countdown-timer');
          if (params.timer) {
            timer.style.display = '';
            let count = 10;
            timer.innerText = `Countdown: ${count}`;
            clearInterval(timer._interval);
            timer._interval = setInterval(() => {
              count--;
              timer.innerText = `Countdown: ${count}`;
              if (count <= 0) { clearInterval(timer._interval); timer.innerText = 'Done!'; }
            }, 1000);
          } else {
            timer.style.display = 'none';
            clearInterval(timer._interval);
          }
          let emailError = document.getElementById('email-error');
          if (params.inputError) {
            if (!emailError) {
              emailError = document.createElement('div');
              emailError.id = 'email-error';
              emailError.className = 'text-red-500 text-xs mt-1';
              emailError.innerText = 'Invalid email address.';
              const emailInput = document.getElementById('email');
              emailInput && emailInput.parentNode.appendChild(emailError);
            }
            emailError.style.display = '';
          } else if (emailError) { emailError.style.display = 'none'; }
          if (params.ruler) showRuler(); else hideRuler();
          // --- Font & Text ---
          // Font family
          document.body.classList.remove('font-serif', 'font-sans', 'font-mono', 'font-roboto');
          if (params.font === 'serif') {
            document.body.classList.add('font-serif');
            document.body.style.fontFamily = '';
          } else if (params.font === 'mono') {
            document.body.classList.add('font-mono');
            document.body.style.fontFamily = '';
          } else if (params.font === 'raleway') {
            document.body.classList.add('font-sans');
            document.body.style.fontFamily = 'Raleway, Arial, sans-serif';
          } else {
            document.body.classList.add('font-sans');
            document.body.style.fontFamily = '';
          }
          // Font size
          document.body.classList.remove('text-lg', 'text-base', 'text-sm');
          if (params.fontSize === 'large') document.body.classList.add('text-lg');
          else if (params.fontSize === 'small') document.body.classList.add('text-sm');
          else document.body.classList.add('text-base');
          // Font colour
          if (params.fontColour) document.body.style.color = params.fontColour;
          else document.body.style.color = '';
          // Bold
          document.body.classList.toggle('font-bold', !!params.fontBold);
          // Subheading radio logic
          const subtitle = document.getElementById('login-subtitle');
          subtitle.classList.remove('truncate', 'cursor-help');
          subtitle.removeAttribute('title');
          const longSubheadingFull = 'Welcome back! Please enter your details. This is a very long subheading to test overflow and wrapping in the login panel. It should wrap and remain readable.';
          const longSubheadingTrimmed = 'Welcome back! Please enter your details...';
          if (params.subheadingStyle === 'long') {
            subtitle.innerText = longSubheadingFull;
          } else if (params.subheadingStyle === 'ellipsis') {
            subtitle.innerText = longSubheadingTrimmed;
            subtitle.classList.add('truncate', 'cursor-help');
            subtitle.title = longSubheadingFull;
            subtitle.style.maxWidth = '100%';
            subtitle.style.display = 'block';
          } else {
            subtitle.innerText = 'Welcome back! Please enter your details';
          }
          // Fallback Font
          document.body.style.fontFamily = params.fallbackFont ? 'Arial, sans-serif' : '';
          // --- Layout & Visuals ---
          // No Shadow
          card && (params.shadow === 'off' || params.shadow === false ? card.classList.remove('shadow-2xl') : card.classList.add('shadow-2xl'));
          // Right-to-Left Layout
          document.body.dir = params.rtl ? 'rtl' : 'ltr';
          // Dark Theme
          if (params.theme) document.body.classList.add('dark'); else document.body.classList.remove('dark');
          // Invert Colors
          if (params.invert) document.body.classList.add('invert', '[filter:invert(1)]'); else document.body.classList.remove('invert', '[filter:invert(1)]');
          // Show Grid
          let grid = document.getElementById('grid-overlay');
          if (params.grid) {
            if (!grid) {
              grid = document.createElement('div');
              grid.id = 'grid-overlay';
              grid.className = 'pointer-events-none fixed inset-0 z-50';
              grid.innerHTML = '<div class="w-full h-full grid grid-cols-12 grid-rows-12 gap-0 opacity-30">' + Array(144).fill('<div class="border border-purple-400"></div>').join('') + '</div>';
              document.body.appendChild(grid);
            }
            grid.style.display = '';
          } else if (grid) { grid.style.display = 'none'; }
          // Show static banner if params.banner is set
          const staticBanner = document.getElementById('static-banner');
          if (params.banner && staticBanner) {
            staticBanner.style.display = '';
          } else if (staticBanner) {
            staticBanner.style.display = 'none';
          }
          // Show Cookie Banner
          if (params.cookie) showCookieBanner(); else hideCookieBanner();
          // Show Popup
          if (params.popup) showPopup(); else hidePopup();
          // Show Toast
          if (params.toast) showToast();
          // Show Floating Box
          if (params.floatingBox) {
            if (!floatBox) {
              floatBox = document.createElement('div');
              floatBox.id = 'floating-box';
              floatBox.className = 'fixed top-20 right-20 bg-purple-100 border-2 border-purple-400 rounded-xl shadow-lg px-6 py-4 z-50 animate-bounce';
              floatBox.innerHTML = '<b>Floating Box</b><br>This is a floating box.';
              document.body.appendChild(floatBox);
            }
            floatBox.style.display = '';
          } else if (floatBox) { floatBox.style.display = 'none'; }
          // Extra Padding
          card && (params.extraPadding ? card.classList.add('p-12') : card.classList.remove('p-12'));
          // In applyVisualParams, update Offset Vertical and Extra Padding logic:
          const mainCard = document.getElementById('main-card');
          const mainCardParent = mainCard && mainCard.parentElement;
          if (params.offsetVertical && mainCardParent) {
            mainCardParent.style.marginTop = '32px';
          } else if (mainCardParent) {
            mainCardParent.style.marginTop = '';
          }
          // Extra Padding for all cells
          if (params.extraPadding && mainCard) {
            mainCard.querySelectorAll(':scope > div').forEach(child => child.classList.add('p-12'));
          } else if (mainCard) {
            mainCard.querySelectorAll(':scope > div').forEach(child => child.classList.remove('p-12'));
          }
          // Animate SSO buttons and header-btn-group
          const ssoBtns = document.querySelectorAll('.grid.grid-cols-3 button');
          const headerBtnGroup = document.getElementById('header-btn-group');
          if (params.anim) {
            ssoBtns.forEach(btn => btn.classList.add('animate-bounce'));
            headerBtnGroup && headerBtnGroup.classList.add('animate-pulse');
          } else {
            ssoBtns.forEach(btn => btn.classList.remove('animate-bounce'));
            headerBtnGroup && headerBtnGroup.classList.remove('animate-pulse');
          }
          // Hide Form
          const loginForm = document.getElementById('login-form');
          if (params.hideForm && loginForm) {
            loginForm.style.visibility = 'hidden';
            loginForm.style.opacity = '0';
            loginForm.style.pointerEvents = 'none';
            loginForm.style.height = '';
          } else if (loginForm) {
            loginForm.style.visibility = '';
            loginForm.style.opacity = '';
            loginForm.style.pointerEvents = '';
            loginForm.style.height = '';
          }
          // Alternate Button Style
          const loginBtn = document.getElementById('login-btn');
          if (params.buttonStyle && loginBtn) {
            loginBtn.classList.add('bg-pink-500', 'hover:bg-pink-600', 'border-2', 'border-pink-700', 'shadow-lg');
            loginBtn.classList.remove('bg-purple-500', 'hover:bg-purple-600');
            // Ensure width, padding, margin, and alignment are always the same
            loginBtn.classList.add('w-full', 'py-2', 'rounded-md', 'font-semibold', 'transition', 'mb-2');
          } else if (loginBtn) {
            loginBtn.classList.remove('bg-pink-500', 'hover:bg-pink-600', 'border-2', 'border-pink-700', 'shadow-lg');
            loginBtn.classList.add('bg-purple-500', 'hover:bg-purple-600');
            // Ensure width, padding, margin, and alignment are always the same
            loginBtn.classList.add('w-full', 'py-2', 'rounded-md', 'font-semibold', 'transition', 'mb-2');
          }
          // Subtle style for SSO buttons
          const ssoBtnsSubtle = document.querySelectorAll('.grid.grid-cols-3 button');
          if (params.buttonStyle) {
            ssoBtnsSubtle.forEach(btn => {
              btn.classList.add('border-purple-400', 'shadow-md', 'bg-purple-50', 'hover:bg-purple-100');
              // Ensure width, padding, margin, and alignment are always the same
              btn.classList.add('border', 'rounded-md', 'py-2', 'w-32', 'mx-auto', 'flex', 'items-center', 'justify-center', 'gap-2', 'text-sm');
            });
          } else {
            ssoBtnsSubtle.forEach(btn => {
              btn.classList.remove('border-purple-400', 'shadow-md', 'bg-purple-50', 'hover:bg-purple-100');
              // Ensure width, padding, margin, and alignment are always the same
              btn.classList.add('border', 'rounded-md', 'py-2', 'w-32', 'mx-auto', 'flex', 'items-center', 'justify-center', 'gap-2', 'text-sm');
            });
          }
          // Hide One Social Button (hide a random social button, but preserve layout)
          const ssoBtnsAll = document.querySelectorAll('.grid.grid-cols-3 button');
          if (params.hideSocial && ssoBtnsAll.length > 0) {
            // First, show all buttons
            ssoBtnsAll.forEach(btn => btn.style.visibility = 'visible');
            // Hide a random one (preserve space)
            const randomIdx = Math.floor(Math.random() * ssoBtnsAll.length);
            ssoBtnsAll[randomIdx].style.visibility = 'hidden';
          } else if (ssoBtnsAll.length > 0) {
            ssoBtnsAll.forEach(btn => btn.style.visibility = 'visible');
          }
          // Show Countdown
          const countdownDiv = document.getElementById('countdown-timer');
          if (params.timer && countdownDiv) {
            countdownDiv.classList.remove('hidden');
            let seconds = 10;
            countdownDiv.innerText = `Countdown: ${seconds}s`;
            if (window.countdownInterval) clearInterval(window.countdownInterval);
            window.countdownInterval = setInterval(() => {
              seconds--;
              if (seconds <= 0) {
                countdownDiv.innerText = 'Time is up!';
                clearInterval(window.countdownInterval);
              } else {
                countdownDiv.innerText = `Countdown: ${seconds}s`;
              }
            }, 1000);
          } else if (countdownDiv) {
            countdownDiv.classList.add('hidden');
            countdownDiv.innerText = '';
            if (window.countdownInterval) clearInterval(window.countdownInterval);
          }
          // Show Input Error
          const emailInput = document.getElementById('email');
          if (params.inputError && emailInput) {
            emailInput.classList.add('border-red-500');
            let error = document.getElementById('email-error');
            if (!error) {
              error = document.createElement('div');
              error.id = 'email-error';
              error.className = 'text-red-500 text-xs mt-1';
              error.innerText = 'Invalid email address.';
              emailInput.parentElement.appendChild(error);
            }
          } else if (emailInput) {
            emailInput.classList.remove('border-red-500');
            const error = document.getElementById('email-error');
            if (error) error.remove();
          }
          // Hide Footer
          const pageFooter = document.querySelector('footer');
          if (params.hideFooter && pageFooter) {
            pageFooter.style.display = 'none';
          } else if (pageFooter) {
            pageFooter.style.display = '';
          }
          // --- Image Effects ---
          // Canvas/WebGL logic
          let canvas = document.getElementById('login-canvas');
          if (params.imageMode === 'canvas') {
            if (sliderImg) sliderImg.style.display = 'none';
            // Create canvas if not present
            if (!canvas && loginRight) {
              canvas = document.createElement('canvas');
              canvas.id = 'login-canvas';
              canvas.width = loginRight.offsetWidth || 400;
              canvas.height = loginRight.offsetHeight || 320;
              canvas.style.width = '100%';
              canvas.style.height = '100%';
              canvas.style.display = 'block';
              canvas.style.borderRadius = '0 24px 24px 0';
              canvas.style.position = 'absolute';
              canvas.style.top = '0';
              canvas.style.left = '0';
              loginRight.appendChild(canvas);
              // --- WebGL 3D Spinning Cube ---
              function webglCube(canvas) {
                const gl = canvas.getContext('webgl') || canvas.getContext('experimental-webgl');
                if (!gl) { canvas.getContext('2d').fillText('WebGL not supported', 10, 50); return; }
                // Vertex shader program
                const vsSource = `
              attribute vec4 aVertexPosition;
              attribute vec4 aVertexColor;
              uniform mat4 uModelViewMatrix;
              uniform mat4 uProjectionMatrix;
              varying lowp vec4 vColor;
              void main(void) {
                gl_Position = uProjectionMatrix * uModelViewMatrix * aVertexPosition;
                vColor = aVertexColor;
              }
            `;
                // Fragment shader program
                const fsSource = `
              varying lowp vec4 vColor;
              void main(void) {
                gl_FragColor = vColor;
              }
            `;
                function loadShader(type, source) {
                  const shader = gl.createShader(type);
                  gl.shaderSource(shader, source);
                  gl.compileShader(shader);
                  if (!gl.getShaderParameter(shader, gl.COMPILE_STATUS)) {
                    gl.deleteShader(shader);
                    return null;
                  }
                  return shader;
                }
                const vertexShader = loadShader(gl.VERTEX_SHADER, vsSource);
                const fragmentShader = loadShader(gl.FRAGMENT_SHADER, fsSource);
                const shaderProgram = gl.createProgram();
                gl.attachShader(shaderProgram, vertexShader);
                gl.attachShader(shaderProgram, fragmentShader);
                gl.linkProgram(shaderProgram);
                if (!gl.getProgramParameter(shaderProgram, gl.LINK_STATUS)) return;
                const programInfo = {
                  program: shaderProgram,
                  attribLocations: {
                    vertexPosition: gl.getAttribLocation(shaderProgram, 'aVertexPosition'),
                    vertexColor: gl.getAttribLocation(shaderProgram, 'aVertexColor'),
                  },
                  uniformLocations: {
                    projectionMatrix: gl.getUniformLocation(shaderProgram, 'uProjectionMatrix'),
                    modelViewMatrix: gl.getUniformLocation(shaderProgram, 'uModelViewMatrix'),
                  },
                };
                // Cube positions
                const positions = [
                  // Front face
                  -1.0, -1.0, 1.0,
                  1.0, -1.0, 1.0,
                  1.0, 1.0, 1.0,
                  -1.0, 1.0, 1.0,
                  // Back face
                  -1.0, -1.0, -1.0,
                  -1.0, 1.0, -1.0,
                  1.0, 1.0, -1.0,
                  1.0, -1.0, -1.0,
                  // Top face
                  -1.0, 1.0, -1.0,
                  -1.0, 1.0, 1.0,
                  1.0, 1.0, 1.0,
                  1.0, 1.0, -1.0,
                  // Bottom face
                  -1.0, -1.0, -1.0,
                  1.0, -1.0, -1.0,
                  1.0, -1.0, 1.0,
                  -1.0, -1.0, 1.0,
                  // Right face
                  1.0, -1.0, -1.0,
                  1.0, 1.0, -1.0,
                  1.0, 1.0, 1.0,
                  1.0, -1.0, 1.0,
                  // Left face
                  -1.0, -1.0, -1.0,
                  -1.0, -1.0, 1.0,
                  -1.0, 1.0, 1.0,
                  -1.0, 1.0, -1.0,
                ];
                const positionBuffer = gl.createBuffer();
                gl.bindBuffer(gl.ARRAY_BUFFER, positionBuffer);
                gl.bufferData(gl.ARRAY_BUFFER, new Float32Array(positions), gl.STATIC_DRAW);
                // Colors for each face
                const faceColors = [
                  [1.0, 0.0, 0.0, 1.0],    // Front: red
                  [0.0, 1.0, 0.0, 1.0],    // Back: green
                  [0.0, 0.0, 1.0, 1.0],    // Top: blue
                  [1.0, 1.0, 0.0, 1.0],    // Bottom: yellow
                  [1.0, 0.0, 1.0, 1.0],    // Right: magenta
                  [0.0, 1.0, 1.0, 1.0],    // Left: cyan
                ];
                let colors = [];
                for (let j = 0; j < faceColors.length; ++j) {
                  const c = faceColors[j];
                  colors = colors.concat(c, c, c, c);
                }
                const colorBuffer = gl.createBuffer();
                gl.bindBuffer(gl.ARRAY_BUFFER, colorBuffer);
                gl.bufferData(gl.ARRAY_BUFFER, new Float32Array(colors), gl.STATIC_DRAW);
                // Indices
                const indices = [
                  0, 1, 2, 0, 2, 3,    // front
                  4, 5, 6, 4, 6, 7,    // back
                  8, 9, 10, 8, 10, 11,    // top
                  12, 13, 14, 12, 14, 15,    // bottom
                  16, 17, 18, 16, 18, 19,    // right
                  20, 21, 22, 20, 22, 23,    // left
                ];
                const indexBuffer = gl.createBuffer();
                gl.bindBuffer(gl.ELEMENT_ARRAY_BUFFER, indexBuffer);
                gl.bufferData(gl.ELEMENT_ARRAY_BUFFER, new Uint16Array(indices), gl.STATIC_DRAW);
                // Draw scene
                let cubeRotation = 0;
                function drawScene() {
                  gl.viewport(0, 0, canvas.width, canvas.height);
                  gl.clearColor(0.98, 0.96, 1, 1.0);
                  gl.clearDepth(1.0);
                  gl.enable(gl.DEPTH_TEST);
                  gl.depthFunc(gl.LEQUAL);
                  gl.clear(gl.COLOR_BUFFER_BIT | gl.DEPTH_BUFFER_BIT);
                  // Perspective matrix
                  const fieldOfView = 45 * Math.PI / 180;
                  const aspect = canvas.width / canvas.height;
                  const zNear = 0.1;
                  const zFar = 100.0;
                  const projectionMatrix = mat4.create();
                  mat4.perspective(projectionMatrix, fieldOfView, aspect, zNear, zFar);
                  // Model view
                  const modelViewMatrix = mat4.create();
                  mat4.translate(modelViewMatrix, modelViewMatrix, [0.0, 0.0, -6.0]);
                  mat4.rotate(modelViewMatrix, modelViewMatrix, cubeRotation, [0, 1, 1]);
                  // Positions
                  {
                    const numComponents = 3;
                    const type = gl.FLOAT;
                    const normalize = false;
                    const stride = 0;
                    const offset = 0;
                    gl.bindBuffer(gl.ARRAY_BUFFER, positionBuffer);
                    gl.vertexAttribPointer(
                      programInfo.attribLocations.vertexPosition,
                      numComponents,
                      type,
                      normalize,
                      stride,
                      offset);
                    gl.enableVertexAttribArray(programInfo.attribLocations.vertexPosition);
                  }
                  // Colors
                  {
                    const numComponents = 4;
                    const type = gl.FLOAT;
                    const normalize = false;
                    const stride = 0;
                    const offset = 0;
                    gl.bindBuffer(gl.ARRAY_BUFFER, colorBuffer);
                    gl.vertexAttribPointer(
                      programInfo.attribLocations.vertexColor,
                      numComponents,
                      type,
                      normalize,
                      stride,
                      offset);
                    gl.enableVertexAttribArray(programInfo.attribLocations.vertexColor);
                  }
                  gl.bindBuffer(gl.ELEMENT_ARRAY_BUFFER, indexBuffer);
                  gl.useProgram(programInfo.program);
                  gl.uniformMatrix4fv(
                    programInfo.uniformLocations.projectionMatrix,
                    false,
                    projectionMatrix);
                  gl.uniformMatrix4fv(
                    programInfo.uniformLocations.modelViewMatrix,
                    false,
                    modelViewMatrix);
                  {
                    const vertexCount = 36;
                    const type = gl.UNSIGNED_SHORT;
                    const offset = 0;
                    gl.drawElements(gl.TRIANGLES, vertexCount, type, offset);
                  }
                  cubeRotation += 0.02;
                  if (canvas && params.imageMode === 'canvas') {
                    canvas._animFrame = requestAnimationFrame(drawScene);
                  }
                }
                // mat4 utility
                const mat4 = {
                  create: function () { return new Float32Array(16).fill(0).map((v, i) => i % 5 === 0 ? 1 : 0); },
                  perspective: function (out, fovy, aspect, near, far) {
                    const f = 1.0 / Math.tan(fovy / 2), nf = 1 / (near - far);
                    out[0] = f / aspect; out[1] = 0; out[2] = 0; out[3] = 0;
                    out[4] = 0; out[5] = f; out[6] = 0; out[7] = 0;
                    out[8] = 0; out[9] = 0; out[10] = (far + near) * nf; out[11] = -1;
                    out[12] = 0; out[13] = 0; out[14] = (2 * far * near) * nf; out[15] = 0;
                  },
                  translate: function (out, a, v) {
                    out[12] = a[12] + v[0]; out[13] = a[13] + v[1]; out[14] = a[14] + v[2];
                  },
                  rotate: function (out, a, rad, axis) {
                    let x = axis[0], y = axis[1], z = axis[2];
                    let len = Math.hypot(x, y, z);
                    if (len < 0.000001) return null;
                    len = 1 / len; x *= len; y *= len; z *= len;
                    const s = Math.sin(rad), c = Math.cos(rad), t = 1 - c;
                    const a00 = a[0], a01 = a[1], a02 = a[2], a03 = a[3];
                    const a10 = a[4], a11 = a[5], a12 = a[6], a13 = a[7];
                    const a20 = a[8], a21 = a[9], a22 = a[10], a23 = a[11];
                    // Construct the elements of the rotation matrix
                    const b00 = x * x * t + c, b01 = y * x * t + z * s, b02 = z * x * t - y * s;
                    const b10 = x * y * t - z * s, b11 = y * y * t + c, b12 = z * y * t + x * s;
                    const b20 = x * z * t + y * s, b21 = y * z * t - x * s, b22 = z * z * t + c;
                    // Perform rotation-specific matrix multiplication
                    out[0] = a00 * b00 + a10 * b01 + a20 * b02;
                    out[1] = a01 * b00 + a11 * b01 + a21 * b02;
                    out[2] = a02 * b00 + a12 * b01 + a22 * b02;
                    out[3] = a03 * b00 + a13 * b01 + a23 * b02;
                    out[4] = a00 * b10 + a10 * b11 + a20 * b12;
                    out[5] = a01 * b10 + a11 * b11 + a21 * b12;
                    out[6] = a02 * b10 + a12 * b11 + a22 * b12;
                    out[7] = a03 * b10 + a13 * b11 + a23 * b12;
                    out[8] = a00 * b20 + a10 * b21 + a20 * b22;
                    out[9] = a01 * b20 + a11 * b21 + a21 * b22;
                    out[10] = a02 * b20 + a12 * b21 + a22 * b22;
                    out[11] = a03 * b20 + a13 * b21 + a23 * b22;
                    out[12] = a[12]; out[13] = a[13]; out[14] = a[14]; out[15] = a[15];
                  },
                };
                drawScene();
              }
              webglCube(canvas);
            }
          } else {
            if (sliderImg) sliderImg.style.display = '';
            if (canvas) {
              if (canvas._animFrame) cancelAnimationFrame(canvas._animFrame);
              canvas.remove();
            }
          }
          // Reset all effects
          if (sliderImg && params.imageMode !== 'canvas') {
            sliderImg.style.filter = '';
            sliderImg.style.display = '';
            sliderImg.style.opacity = '';
            sliderImg.src = 'https://images.unsplash.com/photo-1513258496099-48168024aec0?auto=format&fit=crop&w=540&q=80';
            sliderImg.classList.remove('high-contrast-img', 'distorted-img');
            const overlay = document.getElementById('img-overlay');
            if (overlay) overlay.remove();
          }
          // Blur
          if (params.blur && sliderImg) sliderImg.style.filter += ' blur(6px)';
          // Grayscale
          if (params.grayscale && sliderImg) sliderImg.style.filter += ' grayscale(1)';
          // High Contrast
          if (params.highContrast && sliderImg) {
            sliderImg.classList.add('high-contrast-img');
            // fallback for browsers: also add filter
            sliderImg.style.filter += ' contrast(2) brightness(1.2)';
          }
          // Overlay
          if (params.overlay && sliderImg) {
            let overlay = document.getElementById('img-overlay');
            if (!overlay) {
              overlay = document.createElement('div');
              overlay.id = 'img-overlay';
              overlay.className = 'absolute inset-0 bg-black bg-opacity-40 pointer-events-none rounded-r-3xl';
              sliderImg.parentElement.appendChild(overlay);
            }
          }
          // Hide Image
          if (params.hideImage && sliderImg) sliderImg.style.display = 'none';
          // Enable Image Slider
          if (typeof showSlider === 'function') showSlider(params.imageMode === 'slider');
          // Simulate Broken Image
          if (params.brokenImage && sliderImg) sliderImg.src = 'broken-link.jpg';
          // Random Pixel (add one 9x9 pixel at random location)
          if (params.randomPixel && sliderImg) {
            // Ensure parent is relative
            const parent = sliderImg.parentElement;
            if (parent && getComputedStyle(parent).position === 'static') {
              parent.style.position = 'relative';
            }
            function drawNoise() {
              let canvas = document.getElementById('img-noise');
              if (!canvas) {
                canvas = document.createElement('canvas');
                canvas.id = 'img-noise';
                canvas.className = 'absolute inset-0 pointer-events-none rounded-r-3xl';
                canvas.style.zIndex = 10;
                parent.appendChild(canvas);
              }
              // Match displayed size
              const rect = sliderImg.getBoundingClientRect();
              canvas.width = sliderImg.offsetWidth;
              canvas.height = sliderImg.offsetHeight;
              canvas.style.width = sliderImg.offsetWidth + 'px';
              canvas.style.height = sliderImg.offsetHeight + 'px';
              canvas.style.left = sliderImg.offsetLeft + 'px';
              canvas.style.top = sliderImg.offsetTop + 'px';
              const ctx = canvas.getContext('2d');
              ctx.clearRect(0, 0, canvas.width, canvas.height);
              // Draw several random pixels for visibility
              for (let i = 0; i < 8; i++) {
                const x = Math.floor(Math.random() * (canvas.width - 9));
                const y = Math.floor(Math.random() * (canvas.height - 9));
                const color = `rgba(${Math.floor(Math.random() * 256)},${Math.floor(Math.random() * 256)},${Math.floor(Math.random() * 256)},1)`;
                ctx.fillStyle = color;
                ctx.fillRect(x, y, 9, 9);
              }
            }
            if (sliderImg.complete && sliderImg.offsetWidth > 0 && sliderImg.offsetHeight > 0) {
              drawNoise();
            } else {
              sliderImg.onload = drawNoise;
            }
          } else {
            const canvas = document.getElementById('img-noise');
            if (canvas) canvas.remove();
          }
          // Distorted Image (stretched horizontally)
          if (params.distortedImage && sliderImg) {
            sliderImg.classList.add('distorted-img');
            sliderImg.style.transform = 'scaleX(1.35)';
          } else if (sliderImg) {
            sliderImg.style.transform = '';
            sliderImg.classList.remove('distorted-img');
          }
          // Progressive Blur
          if (params.progressiveBlur && sliderImg) {
            sliderImg.style.transition = 'filter 1.2s cubic-bezier(.4,2,.6,1)';
            sliderImg.style.filter += ' blur(16px)';
            setTimeout(() => { sliderImg.style.filter = sliderImg.style.filter.replace('blur(16px)', 'blur(0px)'); }, 100);
          } else if (sliderImg) {
            sliderImg.style.transition = '';
          }
          // Bento Grid overlay in login-right
          // --- Bento Grid Replacement Logic ---
          // Remove any existing bento grid
          const oldBento = document.getElementById('bento-grid');
          if (oldBento) oldBento.remove();
          if ((params.imageMode === 'bentoGrid' || params.imageMode === 'brokenImage') && loginRight) {
            // Hide image and canvas
            if (sliderImg) sliderImg.style.display = 'none';
            const canvas = document.getElementById('login-canvas');
            if (canvas) canvas.style.display = 'none';
            // Remove any existing bento grid
            const oldBento = document.getElementById('bento-grid');
            if (oldBento) oldBento.remove();
            // Use broken images if imageMode is 'brokenImage'
            const isBroken = params.imageMode === 'brokenImage';
            // Helper for image or broken icon
            function imgOrBroken(src, alt) {
              return isBroken
                ? `<img src='broken-image.png' alt='Broken' style='width:32px;height:32px;object-fit:contain;'>`
                : `<img src='${src}' alt='${alt}' style='width:32px;height:32px;object-fit:contain;'>`;
            }
            // Central tile image
            function centralImg() {
              return isBroken
                ? `<img src='broken-image.png' alt='Broken' style='width:40px;height:40px;object-fit:contain;'>`
                : `<img src='https://raw.githubusercontent.com/github/explore/main/topics/visual-studio-code/visual-studio-code.png' alt='VS Code' style='width:40px;height:40px;object-fit:contain;'>`;
            }
            // Create and insert new bento grid UI
            const bento = document.createElement('div');
            bento.id = 'bento-grid';
            bento.style.display = 'grid';
            bento.style.gridTemplateAreas = `
          'react react vue angular'
          'node central central svelte'
          'ts central central graphql'
          'webpack vite rest rest'
        `;
            bento.style.gridTemplateRows = '1fr 1.2fr 1.2fr 1fr';
            bento.style.gridTemplateColumns = '1.1fr 1.2fr 1.2fr 1.1fr';
            bento.style.gap = '10px';
            bento.style.position = 'absolute';
            bento.style.inset = '0';
            bento.style.width = '100%';
            bento.style.height = '100%';
            bento.style.boxSizing = 'border-box';
            bento.style.padding = '12px';
            bento.style.zIndex = '30';
            bento.innerHTML = `
          <div style="grid-area:react;background:#fff;border-radius:1.2rem;display:flex;flex-direction:column;align-items:center;justify-content:center;box-shadow:0 2px 12px 0 rgba(75,31,166,0.08);border:1.2px solid rgba(75,31,166,0.10);padding:8px;">
            ${imgOrBroken('https://raw.githubusercontent.com/github/explore/main/topics/react/react.png', 'React')}
            <div style='font-weight:bold;font-size:1em;margin-top:4px;'>React</div>
            <div style='color:#7c3aed;font-size:0.9em;'>SPA</div>
          </div>
          <div style="grid-area:vue;background:#fff;border-radius:1.2rem;display:flex;flex-direction:column;align-items:center;justify-content:center;box-shadow:0 2px 12px 0 rgba(75,31,166,0.08);border:1.2px solid rgba(75,31,166,0.10);padding:8px;">
            ${imgOrBroken('https://raw.githubusercontent.com/github/explore/main/topics/vue/vue.png', 'Vue')}
            <div style='font-weight:bold;font-size:1em;margin-top:4px;'>Vue</div>
            <div style='color:#7c3aed;font-size:0.9em;'>MVVM</div>
          </div>
          <div style="grid-area:angular;background:#fff;border-radius:1.2rem;display:flex;flex-direction:column;align-items:center;justify-content:center;box-shadow:0 2px 12px 0 rgba(75,31,166,0.08);border:1.2px solid rgba(75,31,166,0.10);padding:8px;">
            ${imgOrBroken('https://raw.githubusercontent.com/github/explore/main/topics/angular/angular.png', 'Angular')}
            <div style='font-weight:bold;font-size:1em;margin-top:4px;'>Angular</div>
            <div style='color:#7c3aed;font-size:0.9em;'>Framework</div>
          </div>
          <div style="grid-area:node;background:#fff;border-radius:1.2rem;display:flex;flex-direction:column;align-items:center;justify-content:center;box-shadow:0 2px 12px 0 rgba(75,31,166,0.08);border:1.2px solid rgba(75,31,166,0.10);padding:8px;">
            ${imgOrBroken('https://raw.githubusercontent.com/github/explore/main/topics/nodejs/nodejs.png', 'Node.js')}
            <div style='font-weight:bold;font-size:1em;margin-top:4px;'>Node.js</div>
            <div style='color:#7c3aed;font-size:0.9em;'>Backend</div>
          </div>
          <div style="grid-area:svelte;background:#fff;border-radius:1.2rem;display:flex;flex-direction:column;align-items:center;justify-content:center;box-shadow:0 2px 12px 0 rgba(75,31,166,0.08);border:1.2px solid rgba(75,31,166,0.10);padding:8px;">
            ${imgOrBroken('https://raw.githubusercontent.com/github/explore/main/topics/svelte/svelte.png', 'Svelte')}
            <div style='font-weight:bold;font-size:1em;margin-top:4px;'>Svelte</div>
            <div style='color:#7c3aed;font-size:0.9em;'>Compiler</div>
          </div>
          <div style="grid-area:ts;background:#fff;border-radius:1.2rem;display:flex;flex-direction:column;align-items:center;justify-content:center;box-shadow:0 2px 12px 0 rgba(75,31,166,0.08);border:1.2px solid rgba(75,31,166,0.10);padding:8px;">
            ${imgOrBroken('https://raw.githubusercontent.com/github/explore/main/topics/typescript/typescript.png', 'TypeScript')}
            <div style='font-weight:bold;font-size:1em;margin-top:4px;'>TypeScript</div>
            <div style='color:#7c3aed;font-size:0.9em;'>Typed JS</div>
          </div>
          <div style="grid-area:graphql;background:#fff;border-radius:1.2rem;display:flex;flex-direction:column;align-items:center;justify-content:center;box-shadow:0 2px 12px 0 rgba(75,31,166,0.08);border:1.2px solid rgba(75,31,166,0.10);padding:8px;">
            ${imgOrBroken('https://raw.githubusercontent.com/github/explore/main/topics/graphql/graphql.png', 'GraphQL')}
            <div style='font-weight:bold;font-size:1em;margin-top:4px;'>GraphQL</div>
            <div style='color:#7c3aed;font-size:0.9em;'>API</div>
          </div>
          <div style="grid-area:webpack;background:#fff;border-radius:1.2rem;display:flex;flex-direction:column;align-items:center;justify-content:center;box-shadow:0 2px 12px 0 rgba(75,31,166,0.08);border:1.2px solid rgba(75,31,166,0.10);padding:8px;">
            ${imgOrBroken('https://raw.githubusercontent.com/github/explore/main/topics/webpack/webpack.png', 'Webpack')}
            <div style='font-weight:bold;font-size:1em;margin-top:4px;'>Webpack</div>
            <div style='color:#7c3aed;font-size:0.9em;'>Bundler</div>
          </div>
          <div style="grid-area:vite;background:#fff;border-radius:1.2rem;display:flex;flex-direction:column;align-items:center;justify-content:center;box-shadow:0 2px 12px 0 rgba(75,31,166,0.08);border:1.2px solid rgba(75,31,166,0.10);padding:8px;">
            ${imgOrBroken('https://vitejs.dev/logo.svg', 'Vite')}
            <div style='font-weight:bold;font-size:1em;margin-top:4px;'>Vite</div>
            <div style='color:#7c3aed;font-size:0.9em;'>Dev Server</div>
          </div>
          <div style="grid-area:rest;background:#fff;border-radius:1.2rem;display:flex;flex-direction:column;align-items:center;justify-content:center;box-shadow:0 2px 12px 0 rgba(75,31,166,0.08);border:1.2px solid rgba(75,31,166,0.10);padding:8px;">
            ${isBroken ? `<img src='broken-image.png' alt='Broken' style='width:32px;height:32px;object-fit:contain;'>` : `<svg width="32" height="32" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><rect x="3" y="3" width="18" height="18" rx="4" fill="#7c3aed"/><text x="12" y="18" text-anchor="middle" fill="#fff" font-size="10" font-family="Arial" font-weight="bold">REST</text></svg>`}
            <div style='font-weight:bold;font-size:1em;margin-top:4px;'>REST</div>
            <div style='color:#7c3aed;font-size:0.9em;'>API</div>
          </div>
          <div style="grid-area:central;background:#f3f0fa;border-radius:1.5rem;display:flex;flex-direction:column;align-items:center;justify-content:center;box-shadow:0 4px 24px 0 rgba(75,31,166,0.10);border:1.5px solid #7c3aed;padding:16px 8px;">
            ${centralImg()}
            <div style='font-weight:bold;font-size:1.2em;margin-top:8px;color:#7c3aed;'>Modern Web Stack</div>
            <div style='font-size:1em;margin-top:4px;color:#6b7280;'>Bento Grid Demo</div>
          </div>
        `;
            loginRight.appendChild(bento);
          } else if (params.imageMode === 'canvas' && loginRight) {
            if (sliderImg) sliderImg.style.display = 'none';
            const canvas = document.getElementById('login-canvas');
            if (canvas) canvas.style.display = '';
            const oldBento = document.getElementById('bento-grid');
            if (oldBento) oldBento.remove();
            // ... existing code ...
          } else {
            // Restore image/canvas and remove bento grid
            if (sliderImg) sliderImg.style.display = '';
            const canvas = document.getElementById('login-canvas');
            if (canvas) canvas.style.display = '';
            const oldBento = document.getElementById('bento-grid');
            if (oldBento) oldBento.remove();
          }
          // Place this at the very end of applyVisualParams:
          if (params.hideImage && loginRight) {
            loginRight.querySelectorAll('img').forEach(img => img.style.display = 'none');
            loginRight.querySelectorAll('canvas').forEach(canvas => canvas.style.display = 'none');
            const bento = loginRight.querySelector('#bento-grid');
            if (bento) bento.style.display = 'none';
          } else if (loginRight) {
            loginRight.querySelectorAll('img').forEach(img => img.style.display = '');
            loginRight.querySelectorAll('canvas').forEach(canvas => canvas.style.display = '');
            const bento = loginRight.querySelector('#bento-grid');
            if (bento) bento.style.display = '';
          }
          // --- FORCE IMAGE VISIBLE FOR RANDOM PIXEL MODE ---
          if (params.imageMode === 'randomPixel' && loginRight && sliderImg) {
            sliderImg.style.display = '';
            sliderImg.parentElement && (sliderImg.parentElement.style.display = '');
            loginRight.querySelectorAll('canvas').forEach(canvas => {
              if (canvas.id !== 'img-noise') canvas.style.display = 'none';
            });
            const bento = loginRight.querySelector('#bento-grid');
            if (bento) bento.style.display = 'none';
            // --- Refactored random pixel logic ---
            function drawNoise() {
              let noise = document.getElementById('img-noise');
              if (!noise) {
                noise = document.createElement('canvas');
                noise.id = 'img-noise';
                noise.className = 'absolute inset-0 pointer-events-none rounded-r-3xl';
                noise.style.zIndex = 20;
                noise.style.background = 'rgba(255,0,0,0.05)'; // faint red for debug
                sliderImg.parentElement.appendChild(noise);
              }
              // Match displayed size
              noise.width = sliderImg.offsetWidth;
              noise.height = sliderImg.offsetHeight;
              noise.style.width = sliderImg.offsetWidth + 'px';
              noise.style.height = sliderImg.offsetHeight + 'px';
              noise.style.left = sliderImg.offsetLeft + 'px';
              noise.style.top = sliderImg.offsetTop + 'px';
              const ctx = noise.getContext('2d');
              ctx.clearRect(0, 0, noise.width, noise.height);
              for (let i = 0; i < 8; i++) {
                const x = Math.floor(Math.random() * Math.max(1, noise.width - 9));
                const y = Math.floor(Math.random() * Math.max(1, noise.height - 9));
                const color = `rgba(${Math.floor(Math.random() * 256)},${Math.floor(Math.random() * 256)},${Math.floor(Math.random() * 256)},1)`;
                ctx.fillStyle = color;
                ctx.fillRect(x, y, 9, 9);
              }
            }
            // Always redraw noise when mode is set
            if (sliderImg.offsetWidth > 0 && sliderImg.offsetHeight > 0) {
              drawNoise();
            } else {
              sliderImg.onload = drawNoise;
            }
            // Redraw on window resize
            window.removeEventListener('resize', window._randomPixelResizeHandler || (() => { }));
            window._randomPixelResizeHandler = drawNoise;
            window.addEventListener('resize', drawNoise);
          } else {
            const noise = document.getElementById('img-noise');
            if (noise) noise.remove();
            window.removeEventListener('resize', window._randomPixelResizeHandler || (() => { }));
          }
        }
        paramReset.onclick = () => {
          const defaults = getDefaultParams();
          // Remove all query params for a clean URL
          window.history.replaceState({}, '', window.location.pathname);
          applyVisualParams();
          renderParamForm();
          // Reset font/text styles
          document.body.classList.remove('font-serif', 'font-sans', 'font-mono', 'font-roboto', 'text-lg', 'text-base', 'text-sm', 'font-bold');
          document.body.style.color = '';
          document.body.style.fontFamily = '';
          const subtitle = document.getElementById('login-subtitle');
          if (subtitle) subtitle.innerText = 'Welcome back! Please enter your details';
        };
        helpIcon.onclick = () => {
          helpPanel.classList.remove('side-panel-closed');
          helpPanel.classList.add('side-panel-open');
          helpPanel.style.right = '0';
          renderParamForm();
          showOverlay();
        };
        helpClose.onclick = () => {
          helpPanel.classList.remove('side-panel-open');
          helpPanel.classList.add('side-panel-closed');
          helpPanel.style.right = '-400px';
          hideOverlay();
        };
        helpPanel.classList.add('side-panel-closed');
        // Initial render
        renderParamForm();
        // Apply URL params on load
        applyVisualParams();

        // --- Login/Signup/Forgot Logic (unchanged, but inside DOMContentLoaded) ---
        // ... existing code ...

        // Overlay click closes whichever panel is open
        overlay.onclick = function () {
          if (!sidePanel.classList.contains('side-panel-closed')) {
            sidePanel.classList.remove('side-panel-open');
            sidePanel.classList.add('side-panel-closed');
            sidePanel.style.left = '-400px';
          }
          if (!helpPanel.classList.contains('side-panel-closed')) {
            helpPanel.classList.remove('side-panel-open');
            helpPanel.classList.add('side-panel-closed');
            helpPanel.style.right = '-400px';
          }
          hideOverlay();
        };

        // Language switcher
        const langIcon = document.getElementById('lang-icon');
        const langModal = document.getElementById('lang-modal');
        const langModalClose = document.getElementById('lang-modal-close');
        const langSelect = document.getElementById('lang-select');
        const langApply = document.getElementById('lang-apply');
        langIcon && (langIcon.onclick = function () {
          langModal.classList.remove('hidden');
          // Set current lang in select
          const params = new URLSearchParams(window.location.search);
          const current = params.get('lang') || 'en';
          langSelect.value = current;
        });
        langModalClose && (langModalClose.onclick = function () {
          langModal.classList.add('hidden');
        });
        langApply && (langApply.onclick = function () {
          const params = new URLSearchParams(window.location.search);
          params.set('lang', langSelect.value);
          window.history.replaceState({}, '', `${window.location.pathname}?${params}`);
          setLanguageUI(langSelect.value);
          updateHeaderBtnGroupAlignment();
          langModal.classList.add('hidden');
        });

        // --- Language translations ---
        const translations = {
          en: {
            login: 'Log In',
            subheading: 'Welcome back! Please enter your details',
            forgot: 'forgot password?',
            loginBtn: 'Log in',
            signupBtn: 'Sign Up',
            signupLink: "Don't have account?",
            signup: 'Sign Up',
            backToLogin: 'Back to Login',
            sendReset: 'Send Reset Link',
            name: 'Name',
            email: 'Email',
            password: 'Password',
            confirm: 'Confirm Password',
            info: 'Info',
            settings: 'Settings',
            language: 'Your language',
            apply: 'Apply',
          },
          nl: {
            login: 'Inloggen', subheading: 'Welkom terug! Vul uw gegevens in', forgot: 'wachtwoord vergeten?', loginBtn: 'Inloggen', signupBtn: 'Registreren', signupLink: 'Nog geen account?', signup: 'Registreren', backToLogin: 'Terug naar inloggen', sendReset: 'Stuur resetlink', name: 'Naam', email: 'E-mail', password: 'Wachtwoord', confirm: 'Bevestig wachtwoord', info: 'Info', settings: 'Instellingen', language: 'Uw taal', apply: 'Toepassen',
          },
          fr: {
            login: 'Connexion', subheading: 'Bon retour! Veuillez entrer vos informations', forgot: 'mot de passe oublié ?', loginBtn: 'Connexion', signupBtn: 'S\'inscrire', signupLink: 'Pas de compte ?', signup: 'S\'inscrire', backToLogin: 'Retour à la connexion', sendReset: 'Envoyer le lien', name: 'Nom', email: 'E-mail', password: 'Mot de passe', confirm: 'Confirmez le mot de passe', info: 'Info', settings: 'Paramètres', language: 'Votre langue', apply: 'Appliquer',
          },
          de: {
            login: 'Anmelden', subheading: 'Willkommen zurück! Bitte geben Sie Ihre Daten ein', forgot: 'Passwort vergessen?', loginBtn: 'Anmelden', signupBtn: 'Registrieren', signupLink: 'Noch kein Konto?', signup: 'Registrieren', backToLogin: 'Zurück zum Login', sendReset: 'Link senden', name: 'Name', email: 'E-Mail', password: 'Passwort', confirm: 'Passwort bestätigen', info: 'Info', settings: 'Einstellungen', language: 'Ihre Sprache', apply: 'Anwenden',
          },
          it: {
            login: 'Accedi', subheading: 'Bentornato! Inserisci i tuoi dati', forgot: 'password dimenticata?', loginBtn: 'Accedi', signupBtn: 'Registrati', signupLink: 'Non hai un account?', signup: 'Registrati', backToLogin: 'Torna al login', sendReset: 'Invia link', name: 'Nome', email: 'Email', password: 'Password', confirm: 'Conferma password', info: 'Info', settings: 'Impostazioni', language: 'La tua lingua', apply: 'Applica',
          },
          es: {
            login: 'Iniciar sesión', subheading: '¡Bienvenido! Por favor ingresa tus datos', forgot: '¿olvidaste tu contraseña?', loginBtn: 'Iniciar sesión', signupBtn: 'Registrarse', signupLink: '¿No tienes cuenta?', signup: 'Registrarse', backToLogin: 'Volver al inicio', sendReset: 'Enviar enlace', name: 'Nombre', email: 'Correo electrónico', password: 'Contraseña', confirm: 'Confirmar contraseña', info: 'Info', settings: 'Configuración', language: 'Tu idioma', apply: 'Aplicar',
          },
          hi: {
            login: 'लॉग इन', subheading: 'वापस स्वागत है! कृपया अपनी जानकारी दर्ज करें', forgot: 'पासवर्ड भूल गए?', loginBtn: 'लॉग इन', signupBtn: 'साइन अप', signupLink: 'कोई खाता नहीं?', signup: 'साइन अप', backToLogin: 'लॉगिन पर वापस जाएं', sendReset: 'रीसेट लिंक भेजें', name: 'नाम', email: 'ईमेल', password: 'पासवर्ड', confirm: 'पासवर्ड की पुष्टि करें', info: 'जानकारी', settings: 'सेटिंग्स', language: 'आपकी भाषा', apply: 'लागू करें',
          },
          bn: {
            login: 'লগইন', subheading: 'ফিরে আসার জন্য স্বাগতম! আপনার তথ্য দিন', forgot: 'পাসওয়ার্ড ভুলে গেছেন?', loginBtn: 'লগইন', signupBtn: 'সাইন আপ', signupLink: 'কোনো অ্যাকাউন্ট নেই?', signup: 'সাইন আপ', backToLogin: 'লগইনে ফিরে যান', sendReset: 'রিসেট লিঙ্ক পাঠান', name: 'নাম', email: 'ইমেল', password: 'পাসওয়ার্ড', confirm: 'পাসওয়ার্ড নিশ্চিত করুন', info: 'তথ্য', settings: 'সেটিংস', language: 'আপনার ভাষা', apply: 'প্রয়োগ করুন',
          },
          te: {
            login: 'లాగిన్', subheading: 'మళ్లీ స్వాగతం! దయచేసి మీ వివరాలు నమోదు చేయండి', forgot: 'పాస్వర్డ్ మర్చిపోయారా?', loginBtn: 'లాగిన్', signupBtn: 'సైన్ అప్', signupLink: 'ఖాతా లేదు?', signup: 'సైన్ అప్', backToLogin: 'లాగిన్‌కు తిరిగి వెళ్లండి', sendReset: 'రిసెట్ లింక్ పంపండి', name: 'పేరు', email: 'ఇమെయిల్', password: 'పాస్వర్డ్', confirm: 'పాస్వర్డ్ నిర్ధారించండి', info: 'సమాచారం', settings: 'సెట్టింగ్స్', language: 'మీ భాష', apply: 'వర్తించు',
          },
          mr: {
            login: 'लॉगिन', subheading: 'पुन्हा स्वागत आहे! कृपया आपली माहिती प्रविष्ट करा', forgot: 'पासवर्ड विसरलात?', loginBtn: 'लॉगिन', signupBtn: 'साइन अप', signupLink: 'खाते नाही?', signup: 'साइन अप', backToLogin: 'लॉगिनवर परत जा', sendReset: 'रीसेट लिंक पाठवा', name: 'नाव', email: 'ईमेल', password: 'पासवर्ड', confirm: 'पासवर्डची पुष्टी करा', info: 'माहिती', settings: 'सेटिंग्ज', language: 'आपली भाषा', apply: 'लागू करा',
          },
          ml: {
            login: 'ലോഗിൻ', subheading: 'തിരികെ സ്വാഗതം! ദയവായി നിങ്ങളുടെ വിവരങ്ങൾ നൽകുക', forgot: 'പാസ്‌വേഡ് മറന്നോ?', loginBtn: 'ലോഗിൻ', signupBtn: 'സൈൻ അപ്പ്', signupLink: 'അക്കൗണ്ട് ഇല്ലേ?', signup: 'സൈൻ അപ്പ്', backToLogin: 'ലോഗിനിലേക്ക് മടങ്ങുക', sendReset: 'റീസെറ്റ് ലിങ്ക് അയയ്ക്കുക', name: 'പേര്', email: 'ഇമെയിൽ', password: 'പാസ്‌വേഡ്', confirm: 'പാസ്‌വേഡ് സ്ഥിരീകരിക്കുക', info: 'വിവരം', settings: 'ക്രമീകരണങ്ങൾ', language: 'നിങ്ങളുടെ ഭാഷ', apply: 'പ്രയോഗിക്കുക',
          },
          ar: {
            login: 'تسجيل الدخول', subheading: 'مرحبًا بعودتك! الرجاء إدخال بياناتك', forgot: 'هل نسيت كلمة المرور؟', loginBtn: 'تسجيل الدخول', signupBtn: 'إنشاء حساب', signupLink: 'ليس لديك حساب؟', signup: 'إنشاء حساب', backToLogin: 'العودة لتسجيل الدخول', sendReset: 'إرسال رابط إعادة التعيين', name: 'الاسم', email: 'البريد الإلكتروني', password: 'كلمة المرور', confirm: 'تأكيد كلمة المرور', info: 'معلومات', settings: 'الإعدادات', language: 'لغتك', apply: 'تطبيق',
          },
          zh: {
            login: '登录',
            subheading: '欢迎回来！请输入您的信息',
            signup: '注册',
            signupLink: '没有账号？',
            forgot: '忘记密码？',
            loginBtn: '登录',
            signupBtn: '注册',
            backToLogin: '返回登录',
            sendReset: '发送重置链接',
            name: '姓名',
            email: '电子邮件',
            password: '密码',
            confirm: '确认密码',
            info: '信息',
            settings: '设置',
            language: '选择语言',
            apply: '应用',
          },
          ja: {
            login: 'ログイン',
            subheading: 'お帰りなさい！詳細を入力してください',
            signup: 'サインアップ',
            signupLink: 'アカウントをお持ちでないですか？',
            forgot: 'パスワードをお忘れですか？',
            loginBtn: 'ログイン',
            signupBtn: 'サインアップ',
            backToLogin: 'ログインに戻る',
            sendReset: 'リセットリンクを送信',
            name: '名前',
            email: 'メール',
            password: 'パスワード',
            confirm: 'パスワード確認',
            info: '情報',
            settings: '設定',
            language: '言語を選択',
            apply: '適用',
          },
          ko: {
            login: '로그인',
            subheading: '다시 오신 것을 환영합니다! 정보를 입력하세요',
            signup: '가입하기',
            signupLink: '계정이 없으신가요?',
            forgot: '비밀번호를 잊으셨나요?',
            loginBtn: '로그인',
            signupBtn: '가입하기',
            backToLogin: '로그인으로 돌아가기',
            sendReset: '재설정 링크 보내기',
            name: '이름',
            email: '이메일',
            password: '비밀번호',
            confirm: '비밀번호 확인',
            info: '정보',
            settings: '설정',
            language: '언어 선택',
            apply: '적용',
          },
          ru: {
            login: 'Войти',
            subheading: 'С возвращением! Пожалуйста, введите свои данные',
            signup: 'Зарегистрироваться',
            signupLink: 'Нет аккаунта?',
            forgot: 'Забыли пароль?',
            loginBtn: 'Войти',
            signupBtn: 'Зарегистрироваться',
            backToLogin: 'Назад к входу',
            sendReset: 'Отправить ссылку',
            name: 'Имя',
            email: 'Эл. почта',
            password: 'Пароль',
            confirm: 'Подтвердите пароль',
            info: 'Инфо',
            settings: 'Настройки',
            language: 'Выберите язык',
            apply: 'Применить',
          },
          el: {
            login: 'Σύνδεση',
            subheading: 'Καλώς ήρθατε! Παρακαλώ εισάγετε τα στοιχεία σας',
            signup: 'Εγγραφή',
            signupLink: 'Δεν έχετε λογαριασμό;',
            forgot: 'Ξεχάσατε τον κωδικό;',
            loginBtn: 'Σύνδεση',
            signupBtn: 'Εγγραφή',
            backToLogin: 'Επιστροφή στη σύνδεση',
            sendReset: 'Αποστολή συνδέσμου',
            name: 'Όνομα',
            email: 'Email',
            password: 'Κωδικός',
            confirm: 'Επιβεβαίωση κωδικού',
            info: 'Πληροφορίες',
            settings: 'Ρυθμίσεις',
            language: 'Επιλογή γλώσσας',
            apply: 'Εφαρμογή',
          },
          he: {
            login: 'התחברות',
            subheading: 'ברוך שובך! אנא הזן את פרטיך',
            signup: 'הרשמה',
            signupLink: 'אין לך חשבון?',
            forgot: 'שכחת סיסמה?',
            loginBtn: 'התחבר',
            signupBtn: 'הרשמה',
            backToLogin: 'חזרה להתחברות',
            sendReset: 'שלח קישור איפוס',
            name: 'שם',
            email: 'אימייל',
            password: 'סיסמה',
            confirm: 'אישור סיסמה',
            info: 'מידע',
            settings: 'הגדרות',
            language: 'בחר שפה',
            apply: 'החל',
          },
          th: {
            login: 'เข้าสู่ระบบ',
            subheading: 'ยินดีต้อนรับกลับ! กรุณากรอกรายละเอียดของคุณ',
            signup: 'สมัครสมาชิก',
            signupLink: 'ยังไม่มีบัญชี?',
            forgot: 'ลืมรหัสผ่าน?',
            loginBtn: 'เข้าสู่ระบบ',
            signupBtn: 'สมัครสมาชิก',
            backToLogin: 'กลับไปเข้าสู่ระบบ',
            sendReset: 'ส่งลิงก์รีเซ็ต',
            name: 'ชื่อ',
            email: 'อีเมล',
            password: 'รหัสผ่าน',
            confirm: 'ยืนยันรหัสผ่าน',
            info: 'ข้อมูล',
            settings: 'การตั้งค่า',
            language: 'เลือกภาษา',
            apply: 'ใช้',
          },
        };
        function setLanguageUI(lang) {
          const t = translations[lang] || translations.en;
          document.getElementById('login-heading').innerText = t.login;
          document.getElementById('login-subtitle').innerText = t.subheading;
          const forgot = document.getElementById('forgot-link');
          if (forgot) forgot.innerText = t.forgot;
          const loginBtn = document.getElementById('login-btn');
          if (loginBtn) loginBtn.innerText = t.loginBtn;
          const signupBtn = document.getElementById('signup-btn');
          if (signupBtn) signupBtn.innerText = t.signupBtn;
          const signupLink = document.getElementById('signup-link-row');
          if (signupLink) signupLink.innerHTML = `${t.signupLink}<a href="#" class="text-purple-500 ml-1" id="show-signup">${t.signup}</a>`;
          const backToLogin = document.getElementById('back-to-login');
          if (backToLogin) backToLogin.innerText = t.backToLogin;
          const backToLoginSignup = document.getElementById('back-to-login-signup');
          if (backToLoginSignup) backToLoginSignup.innerText = t.backToLogin;
          const sendReset = document.querySelector('#forgot-fields button[type="submit"]');
          if (sendReset) sendReset.innerText = t.sendReset;
          const nameLabel = document.querySelector('label[for="signup-name"]');
          if (nameLabel) nameLabel.innerText = t.name;
          const emailLabel = document.querySelector('label[for="email"]');
          if (emailLabel) emailLabel.innerText = t.email;
          const signupEmailLabel = document.querySelector('label[for="signup-email"]');
          if (signupEmailLabel) signupEmailLabel.innerText = t.email;
          const forgotEmailLabel = document.querySelector('label[for="forgot-email"]');
          if (forgotEmailLabel) forgotEmailLabel.innerText = t.email;
          const passwordLabel = document.querySelector('label[for="password"]');
          if (passwordLabel) passwordLabel.innerText = t.password;
          const signupPasswordLabel = document.querySelector('label[for="signup-password"]');
          if (signupPasswordLabel) signupPasswordLabel.innerText = t.password;
          const signupConfirmLabel = document.querySelector('label[for="signup-confirm"]');
          if (signupConfirmLabel) signupConfirmLabel.innerText = t.confirm;
          // Info/settings/lang modals
          const infoBtn = document.getElementById('open-side-panel-btn');
          if (infoBtn) infoBtn.title = t.info;
          const helpIcon = document.getElementById('help-icon');
          if (helpIcon) helpIcon.title = t.settings;
          const langModalTitle = document.querySelector('#lang-modal .font-bold');
          if (langModalTitle) langModalTitle.innerText = t.language;
          const langApply = document.getElementById('lang-apply');
          if (langApply) langApply.innerText = t.apply;
          // Update placeholders for all fields
          const emailInput = document.getElementById('email');
          if (emailInput) emailInput.placeholder = t.email;
          const passwordInput = document.getElementById('password');
          if (passwordInput) passwordInput.placeholder = t.password;
          const signupNameInput = document.getElementById('signup-name');
          if (signupNameInput) signupNameInput.placeholder = t.name;
          const signupEmailInput = document.getElementById('signup-email');
          if (signupEmailInput) signupEmailInput.placeholder = t.email;
          const signupPasswordInput = document.getElementById('signup-password');
          if (signupPasswordInput) signupPasswordInput.placeholder = t.password;
          const signupConfirmInput = document.getElementById('signup-confirm');
          if (signupConfirmInput) signupConfirmInput.placeholder = t.confirm;
          const forgotEmailInput = document.getElementById('forgot-email');
          if (forgotEmailInput) forgotEmailInput.placeholder = t.email;
          // Set direction for RTL languages
          const rtlLangs = ['ar', 'he', 'fa', 'ur'];
          document.body.dir = rtlLangs.includes(lang) ? 'rtl' : 'ltr';
          attachSignupLinkHandler(); // Ensure Sign Up link handler is always attached after language change
        }
        // Set language on load
        const urlParams = new URLSearchParams(window.location.search);
        const lang = urlParams.get('lang') || 'en';
        setLanguageUI(lang);

        // Orientation class on body for advanced control
        function setOrientationClass() {
          const isPortrait = window.matchMedia('(orientation: portrait)').matches;
          document.body.classList.toggle('portrait', isPortrait);
          document.body.classList.toggle('landscape', !isPortrait);
        }
        setOrientationClass();
        window.addEventListener('resize', setOrientationClass);

        // --- Login/Signup/Forgot Functionality ---
        function showLogin() {
          document.getElementById('login-fields').style.display = '';
          document.getElementById('forgot-fields').style.display = 'none';
          document.getElementById('signup-fields').style.display = 'none';
          document.getElementById('signup-link-row').style.display = '';
          document.getElementById('login-heading').innerText = translations[lang]?.login || 'Log In';
          document.getElementById('login-subtitle').innerText = translations[lang]?.subheading || 'Welcome back! Please enter your details';
          // Set required only on visible fields
          setRequiredFields(['email', 'password'], ['forgot-email', 'signup-name', 'signup-email', 'signup-password', 'signup-confirm']);
          attachSignupLinkHandler(); // Ensure Sign Up link handler is always attached
        }
        function showForgot() {
          document.getElementById('login-fields').style.display = 'none';
          document.getElementById('forgot-fields').style.display = '';
          document.getElementById('signup-fields').style.display = 'none';
          document.getElementById('signup-link-row').style.display = 'none';
          document.getElementById('login-heading').innerText = translations[lang]?.forgot || 'Forgot Password';
          document.getElementById('login-subtitle').innerText = '';
          setRequiredFields(['forgot-email'], ['email', 'password', 'signup-name', 'signup-email', 'signup-password', 'signup-confirm']);
        }
        function showSignup() {
          document.getElementById('login-fields').style.display = 'none';
          document.getElementById('forgot-fields').style.display = 'none';
          document.getElementById('signup-fields').style.display = '';
          document.getElementById('signup-link-row').style.display = 'none';
          document.getElementById('login-heading').innerText = translations[lang]?.signup || 'Sign Up';
          document.getElementById('login-subtitle').innerText = '';
          setRequiredFields(['signup-name', 'signup-email', 'signup-password', 'signup-confirm'], ['email', 'password', 'forgot-email']);
        }
        // Helper to set required only on visible fields
        function setRequiredFields(requiredIds, notRequiredIds) {
          requiredIds.forEach(id => { const el = document.getElementById(id); if (el) el.setAttribute('required', 'required'); });
          notRequiredIds.forEach(id => { const el = document.getElementById(id); if (el) el.removeAttribute('required'); });
        }
        document.getElementById('forgot-link').onclick = function (e) { e.preventDefault(); showForgot(); };
        document.getElementById('back-to-login').onclick = function (e) { e.preventDefault(); showLogin(); };
        document.getElementById('show-signup').onclick = function (e) { e.preventDefault(); showSignup(); };
        document.getElementById('back-to-login-signup').onclick = function (e) { e.preventDefault(); showLogin(); };

        // --- Social Media Login Popup ---
        function showSocialPopup(type) {
          if (document.getElementById('social-popup')) return;
          const providers = {
            google: { name: 'Google', color: 'bg-white text-gray-900', icon: 'fab fa-google', btn: 'bg-red-500 text-white', brand: '#EA4335', logo: 'https://upload.wikimedia.org/wikipedia/commons/5/53/Google_%22G%22_Logo.svg' },
            facebook: { name: 'Facebook', color: 'bg-white text-gray-900', icon: 'fab fa-facebook-f', btn: 'bg-blue-600 text-white', brand: '#1877F3', logo: 'https://upload.wikimedia.org/wikipedia/commons/0/05/Facebook_Logo_%282019%29.png' },
            apple: { name: 'Apple', color: 'bg-white text-gray-900', icon: 'fab fa-apple', btn: 'bg-black text-white', brand: '#000', logo: 'https://upload.wikimedia.org/wikipedia/commons/f/fa/Apple_logo_black.svg' },
            linkedin: { name: 'LinkedIn', color: 'bg-white text-gray-900', icon: 'fab fa-linkedin-in', btn: 'bg-blue-700 text-white', brand: '#0077B5', logo: 'https://upload.wikimedia.org/wikipedia/commons/c/ca/LinkedIn_logo_initials.png' },
            microsoft: { name: 'Microsoft', color: 'bg-white text-gray-900', icon: 'fab fa-microsoft', btn: 'bg-blue-800 text-white', brand: '#0078D4', logo: 'https://upload.wikimedia.org/wikipedia/commons/4/44/Microsoft_logo.svg' },
            twitter: { name: 'Twitter', color: 'bg-white text-gray-900', icon: 'fab fa-twitter', btn: 'bg-sky-400 text-white', brand: '#1DA1F2', logo: 'https://upload.wikimedia.org/wikipedia/commons/4/4f/Twitter-logo.svg' }
          };
          const p = providers[type] || providers.google;
          const user = { avatar: 'https://randomuser.me/api/portraits/men/32.jpg', name: 'John Doe', email: 'john.doe@email.com' };
          const popup = document.createElement('div');
          popup.id = 'social-popup';
          popup.className = 'fixed inset-0 flex items-center justify-center z-[4000] bg-black bg-opacity-40';
          popup.innerHTML = `
        <div class="bg-white rounded-2xl shadow-2xl w-[92vw] max-w-[340px] text-center relative flex flex-col items-center border border-gray-200 p-6">
          <button id="social-popup-close" class="absolute top-3 right-4 text-2xl text-purple-500 hover:text-purple-700 transition">&times;</button>
          <div class="text-2xl font-bold mb-2 flex items-center gap-2 justify-center" style="color:${p.brand}"><i class="${p.icon}"></i> ${p.name} Sign In</div>
          <div class="flex flex-col items-center mb-4">
            <img src="${user.avatar}" alt="User avatar" class="w-14 h-14 rounded-full border mb-1 shadow">
            <div class="font-semibold text-base">${user.name}</div>
            <div class="text-xs text-gray-500">${user.email}</div>
          </div>
          <div class="mb-4 text-gray-600 text-sm text-left w-full">
            <b>${p.name}</b> will share your name, email address, and profile picture with <b>Visual Regression - Evaluator</b>.<br>
            <span class="text-xs text-gray-400">You can review and remove access at any time in your ${p.name} account settings.</span>
          </div>
          <div class="flex gap-2 w-full mt-2">
            <button id="social-continue" class="flex-1 rounded-lg px-4 py-2 font-semibold shadow hover:opacity-90 transition" style="background:${p.brand};color:#fff;">Continue as ${user.name.split(' ')[0]}</button>
            <button class="flex-1 bg-gray-100 text-gray-700 rounded-lg px-4 py-2 font-semibold shadow hover:bg-gray-200 transition">Cancel</button>
          </div>
        </div>
      `;
          document.body.appendChild(popup);
          const closeBtn = popup.querySelector('#social-popup-close');
          if (closeBtn) closeBtn.onclick = function () { popup.remove(); };
          const cancelBtn = popup.querySelector('.bg-gray-100');
          if (cancelBtn) cancelBtn.onclick = function () { popup.remove(); };
          // SSO login success: redirect to SPA welcome
          const continueBtn = popup.querySelector('#social-continue');
          if (continueBtn) continueBtn.onclick = function () {
            popup.remove();
            // Simulate SPA login success
            const now = new Date();
            const tz = Intl.DateTimeFormat().resolvedOptions().timeZone;
            const formatted = now.toLocaleString() + ' (' + tz + ')';
            localStorage.setItem('lastLogin', formatted);
            const mainCardLeft = document.getElementById('login-left');
            if (mainCardLeft) {
              mainCardLeft.innerHTML = `
            <div class='flex flex-col justify-center items-center h-full w-full p-8'>
              <div class='text-2xl font-bold text-purple-700 mb-2'>Welcome back, <span class='font-extrabold'>${user.email}</span>!</div>
              <div class='text-xs text-gray-500 mb-6'>Last login: ${formatted}</div>
              <button id='logout-btn' class='px-6 py-2 bg-gray-200 text-purple-700 rounded font-semibold shadow hover:bg-gray-300 transition'>Log out</button>
            </div>
          `;
              // Attach logout handler
              const logoutBtn = mainCardLeft.querySelector('#logout-btn');
              if (logoutBtn) {
                logoutBtn.onclick = function () {
                  window.location.reload();
                };
              }
            }
          };
        }
        // Attach to all social buttons
        document.querySelectorAll('button').forEach(btn => {
          if (btn.innerHTML.includes('Google')) btn.onclick = function (e) { e.preventDefault(); showSocialPopup('google'); };
          if (btn.innerHTML.includes('Facebook')) btn.onclick = function (e) { e.preventDefault(); showSocialPopup('facebook'); };
          if (btn.innerHTML.includes('Apple')) btn.onclick = function (e) { e.preventDefault(); showSocialPopup('apple'); };
          if (btn.innerHTML.includes('LinkedIn')) btn.onclick = function (e) { e.preventDefault(); showSocialPopup('linkedin'); };
          if (btn.innerHTML.includes('Microsoft')) btn.onclick = function (e) { e.preventDefault(); showSocialPopup('microsoft'); };
          if (btn.innerHTML.includes('Twitter')) btn.onclick = function (e) { e.preventDefault(); showSocialPopup('twitter'); };
        });

        // After setLanguageUI(lang) in JS, add:
        function updateHeaderBtnGroupAlignment() {
          const group = document.getElementById('header-btn-group');
          if (!group) return;
          if (document.body.dir === 'rtl') {
            group.classList.remove('justify-end');
            group.classList.add('justify-start');
          } else {
            group.classList.remove('justify-start');
            group.classList.add('justify-end');
          }
        }
        // Call updateHeaderBtnGroupAlignment() after setLanguageUI(lang)
        setLanguageUI(lang);
        updateHeaderBtnGroupAlignment();
        // Also call updateHeaderBtnGroupAlignment() inside setLanguageUI(lang) after setting dir

        // Fix 'Don't have account? Sign Up' link to always be clickable
        // In setLanguageUI and after rendering, always re-attach the event listener to #show-signup
        function attachSignupLinkHandler() {
          const signupLink = document.getElementById('show-signup');
          if (signupLink) {
            signupLink.onclick = function (e) { e.preventDefault(); showSignup(); };
          }
        }
        attachSignupLinkHandler();
        // Also call attachSignupLinkHandler() in setLanguageUI after updating innerHTML

        // Forgot password OTP flow
        // In the forgot-fields form, after clicking 'Send Reset Link', replace the form with 6 OTP input boxes, a submit button, and a 'Didn't receive code? Resend code' link
        // On OTP submit, show the login form again
        const forgotForm = document.querySelector('#forgot-fields form, #forgot-fields');
        if (forgotForm) {
          forgotForm.onsubmit = function (e) {
            e.preventDefault();
            // Show OTP input UI
            const forgotFields = document.getElementById('forgot-fields');
            forgotFields.innerHTML = `
          <div class="mb-2 text-center font-semibold">Enter the 6-digit code sent to your email</div>
          <form id="otp-form" class="flex flex-col items-center gap-3">
            <div class="flex gap-2 justify-center mb-2">
              <input type="text" maxlength="1" class="otp-input w-10 h-12 text-2xl text-center border rounded" required>
              <input type="text" maxlength="1" class="otp-input w-10 h-12 text-2xl text-center border rounded" required>
              <input type="text" maxlength="1" class="otp-input w-10 h-12 text-2xl text-center border rounded" required>
              <input type="text" maxlength="1" class="otp-input w-10 h-12 text-2xl text-center border rounded" required>
              <input type="text" maxlength="1" class="otp-input w-10 h-12 text-2xl text-center border rounded" required>
              <input type="text" maxlength="1" class="otp-input w-10 h-12 text-2xl text-center border rounded" required>
            </div>
            <button type="submit" class="w-full py-2 bg-purple-500 text-white rounded-md font-semibold hover:bg-purple-600 transition mb-2">Submit</button>
            <div class="text-sm text-gray-500 mt-2">Didn't receive code? <a href="#" id="resend-otp" class="text-purple-500 underline">Resend code</a></div>
          </form>
        `;
            // OTP input auto-focus
            const otpInputs = forgotFields.querySelectorAll('.otp-input');
            otpInputs.forEach((input, idx) => {
              input.addEventListener('input', function () {
                if (this.value.length === 1 && idx < otpInputs.length - 1) {
                  otpInputs[idx + 1].focus();
                }
              });
              input.addEventListener('keydown', function (e) {
                if (e.key === 'Backspace' && !this.value && idx > 0) {
                  otpInputs[idx - 1].focus();
                }
              });
            });
            // OTP form submit
            forgotFields.querySelector('#otp-form').onsubmit = function (e) {
              e.preventDefault();
              showLogin();
            };
            // Resend code
            forgotFields.querySelector('#resend-otp').onclick = function (e) {
              e.preventDefault();
              // Optionally show a message or re-run the OTP UI
              // For now, just clear the OTP inputs
              otpInputs.forEach(input => input.value = '');
              otpInputs[0].focus();
            };
          };
        }
        // ... existing code ...
        // In setLanguageUI, after updating innerHTML for signup link, call attachSignupLinkHandler();

        const languageOptions = [
          { value: 'en', label: 'English (English)' },
          { value: 'ar', label: 'Arabic (العربية)' },
          { value: 'bn', label: 'Bengali (বাংলা)' },
          { value: 'zh', label: 'Chinese (中文)' },
          { value: 'ja', label: 'Japanese (日本語)' },
          { value: 'ko', label: 'Korean (한국어)' },
          { value: 'ru', label: 'Russian (Русский)' },
          { value: 'el', label: 'Greek (Ελληνικά)' },
          { value: 'he', label: 'Hebrew (עברית)' },
          { value: 'th', label: 'Thai (ไทย)' },
          { value: 'nl', label: 'Dutch (Nederlands)' },
          { value: 'fr', label: 'French (français)' },
          { value: 'de', label: 'German (Deutsch)' },
          { value: 'hi', label: 'Hindi (हिन्दी)' },
          { value: 'it', label: 'Italian (italiano)' },
          { value: 'ml', label: 'Malayalam (മലയാളം)' },
          { value: 'mr', label: 'Marathi (मराठी)' },
          { value: 'es', label: 'Spanish (español)' },
          { value: 'te', label: 'Telugu (తెలుగు)' }
        ].sort((a, b) => a.label.localeCompare(b.label));

        // --- Enable login button only when both Email and Password are entered ---
        const emailInput = document.getElementById('email');
        const passwordInput = document.getElementById('password');
        const loginBtn = document.getElementById('login-btn');
        const lastLoginInfo = document.getElementById('last-login-info');
        function updateLoginBtnState() {
          if (emailInput.value.trim() && passwordInput.value.trim()) {
            loginBtn.disabled = false;
          } else {
            loginBtn.disabled = true;
          }
        }
        emailInput.addEventListener('input', updateLoginBtnState);
        passwordInput.addEventListener('input', updateLoginBtnState);
        // Initial state
        updateLoginBtnState();

        // --- Last Login Info ---
        function showLastLogin() {
          const lastLogin = localStorage.getItem('lastLogin');
          if (lastLogin && lastLoginInfo) {
            lastLoginInfo.textContent = `Last login: ${lastLogin}`;
          } else if (lastLoginInfo) {
            lastLoginInfo.textContent = '';
          }
        }
        showLastLogin();
        // On login form submit, update last login info
        const loginForm = document.getElementById('login-form');
        if (loginForm) {
          // Utility: Remove 'required' from all hidden, disabled, or non-focusable fields before submit (robust)
          function removeRequiredFromHiddenFields(form) {
            form.querySelectorAll('[required]').forEach(el => {
              const isHidden = el.offsetParent === null || window.getComputedStyle(el).display === 'none' || el.closest('[style*="display: none"]');
              const isDisabled = el.disabled;
              const isNotFocusable = el.tabIndex === -1;
              if (isHidden || isDisabled || isNotFocusable) {
                el.removeAttribute('required');
              }
            });
          }
          loginForm.addEventListener('submit', function (e) {
            e.preventDefault(); // Always prevent real submission
            removeRequiredFromHiddenFields(loginForm);
            if (loginBtn.disabled) { return false; }
            const now = new Date();
            const tz = Intl.DateTimeFormat().resolvedOptions().timeZone;
            const formatted = now.toLocaleString() + ' (' + tz + ')';
            localStorage.setItem('lastLogin', formatted);
            // SPA: Replace left panel with welcome and logout
            const mainCardLeft = document.getElementById('login-left');
            if (mainCardLeft) {
              const email = emailInput.value.trim();
              mainCardLeft.innerHTML = `
            <div class='flex flex-col justify-center items-center h-full w-full p-8'>
              <div class='text-2xl font-bold text-purple-700 mb-2'>Welcome back, <span class='font-extrabold'>${email}</span>!</div>
              <div class='text-xs text-gray-500 mb-6'>Last login: ${formatted}</div>
              <button id='logout-btn' class='px-6 py-2 bg-gray-200 text-purple-700 rounded font-semibold shadow hover:bg-gray-300 transition'>Log out</button>
            </div>
          `;
              // Attach logout handler
              const logoutBtn = mainCardLeft.querySelector('#logout-btn');
              if (logoutBtn) {
                logoutBtn.onclick = function () {
                  window.location.reload();
                };
              }
            }
          });
        }
        // ... existing code ...

        // --- Remember Me functionality ---
        const rememberMe = document.getElementById('remember-me');
        // On page load, pre-fill email if remembered
        const rememberedEmail = localStorage.getItem('rememberedEmail');
        if (rememberedEmail) {
          emailInput.value = rememberedEmail;
          if (rememberMe) rememberMe.checked = true;
        }
        // Save or remove email on checkbox/input change
        function updateRememberMe() {
          if (rememberMe && rememberMe.checked) {
            localStorage.setItem('rememberedEmail', emailInput.value);
          } else {
            localStorage.removeItem('rememberedEmail');
          }
        }
        if (rememberMe) {
          rememberMe.addEventListener('change', updateRememberMe);
          emailInput.addEventListener('input', function () {
            if (rememberMe.checked) {
              localStorage.setItem('rememberedEmail', emailInput.value);
            }
          });
        }
        // Fallback: visually grey out login button if disabled (for non-Tailwind environments)
        function updateLoginBtnStyle() {
          if (loginBtn.disabled) {
            loginBtn.style.background = '#e5e7eb'; // gray-200
            loginBtn.style.color = '#9ca3af'; // gray-400
            loginBtn.style.cursor = 'not-allowed';
          } else {
            loginBtn.style.background = '';
            loginBtn.style.color = '';
            loginBtn.style.cursor = '';
          }
        }
        emailInput.addEventListener('input', updateLoginBtnStyle);
        passwordInput.addEventListener('input', updateLoginBtnStyle);
        updateLoginBtnStyle();

        // Log out button logic
        const logoutBtn = document.getElementById('logout-btn');
        if (logoutBtn) {
          logoutBtn.onclick = function () {
            // Hide welcome and logout, reset form
            document.getElementById('welcome-message').classList.add('hidden');
            document.getElementById('logout-row').classList.add('hidden');
            loginForm.reset();
            loginForm.style.display = '';
            // Optionally clear error message
            const errorDiv = document.getElementById('form-error-msg');
            if (errorDiv) errorDiv.textContent = '';
          };
        }

        const mainCardLeft = document.querySelector('#main-card .flex-1');

        // --- Visual Regression Parameters Panel Logic ---
        // ... existing code ...

        // Add Skeleton Loader param to Layout section if not present
        if (!PARAMS.some(p => p.key === 'skeleton')) {
          PARAMS.push({ key: 'skeleton', label: 'Skeleton Loader', value: 'on', type: 'checkbox' });
          // Add to Layout section keys if not present
          const layoutSection = PARAM_SECTIONS.find(s => s.title === 'Layout');
          if (layoutSection && !layoutSection.keys.includes('skeleton')) {
            layoutSection.keys.push('skeleton');
          }
        }
        // ... existing code ...

        function applySkeletonLoader() {
          const params = getCurrentParams();
          const skeleton = document.getElementById('skeleton-loader');
          if (params.skeleton === 'on') {
            skeleton && (skeleton.style.display = 'block');
            document.body.style.overflow = 'hidden';
            // Auto-dismiss after 10 seconds
            if (!window._skeletonTimeout) {
              window._skeletonTimeout = setTimeout(() => {
                // Remove skeleton param from URL
                const params = new URLSearchParams(window.location.search);
                params.delete('skeleton');
                window.history.replaceState({}, '', `${window.location.pathname}?${params}`);
                skeleton.style.display = 'none';
                document.body.style.overflow = '';
                window._skeletonTimeout = null;
              }, 10000);
            }
          } else {
            skeleton && (skeleton.style.display = 'none');
            document.body.style.overflow = '';
            if (window._skeletonTimeout) {
              clearTimeout(window._skeletonTimeout);
              window._skeletonTimeout = null;
            }
          }
        }
        // ... existing code ...

        // On load, show skeleton loader if param is set
        applySkeletonLoader();
        // ... existing code ...

        // Also call applySkeletonLoader after any param change
        // Patch paramForm rendering to call applySkeletonLoader after toggling
        const origRenderParamForm = renderParamForm;
        renderParamForm = function (activeIdx = 0) {
          origRenderParamForm(activeIdx);
          // Attach skeleton loader toggle logic
          const skeletonInput = document.querySelector('input[name="skeleton"]');
          if (skeletonInput) {
            skeletonInput.onchange = function () {
              const params = new URLSearchParams(window.location.search);
              if (skeletonInput.checked) params.set('skeleton', 'on');
              else params.delete('skeleton');
              window.history.replaceState({}, '', `${window.location.pathname}?${params}`);
              applySkeletonLoader();
              renderParamForm(activeParamTab);
            };
          }
        };
        // Initial patch call
        renderParamForm(activeParamTab);
        // ... existing code ...

        // Also call applySkeletonLoader on popstate (URL param change)
        window.addEventListener('popstate', applySkeletonLoader);
        // ... existing code ...

        // Add SVG icons param to Image section if not present
        if (!PARAMS.some(p => p.key === 'svgicons')) {
          PARAMS.push({ key: 'svgicons', label: 'Use SVG icons', value: 'on', type: 'checkbox' });
          // Add to Image section keys if not present
          const imageSection = PARAM_SECTIONS.find(s => s.title === 'Image');
          if (imageSection && !imageSection.keys.includes('svgicons')) {
            imageSection.keys.push('svgicons');
          }
        }

        // --- SVG ICONS ---
        // SVG icon definitions
        const SVG_ICONS = {
          info: `<svg width=\"20\" height=\"20\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\" viewBox=\"0 0 24 24\"><path d=\"M22.7 19.3l-2.4-2.4c1.1-2.1.7-4.7-1.1-6.4-1.8-1.8-4.3-2.2-6.4-1.1l-2.4-2.4c-.4-.4-1-.4-1.4 0l-2.1 2.1c-.4.4-.4 1 0 1.4l2.4 2.4c-1.1 2.1-.7 4.7 1.1 6.4 1.8 1.8 4.3 2.2 6.4 1.1l2.4 2.4c.4.4 1 .4 1.4 0l2.1-2.1c.4-.4.4-1 0-1.4zM7.7 7.7l2.4 2.4c-1.1 2.1-.7 4.7 1.1 6.4 1.8 1.8 4.3 2.2 6.4 1.1l2.4 2.4c.4.4 1 .4 1.4 0l2.1-2.1c.4-.4.4-1 0-1.4l-2.4-2.4c1.1-2.1.7-4.7-1.1-6.4-1.8-1.8-4.3-2.2-6.4-1.1l-2.4-2.4c-.4-.4-1-.4-1.4 0l-2.1 2.1c-.4.4-.4 1 0 1.4z\"/></svg>`,
          globe: `<svg width="20" height="20" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24"><circle cx="12" cy="12" r="10"/><ellipse cx="12" cy="12" rx="10" ry="4"/><ellipse cx="12" cy="12" rx="4" ry="10"/></svg>`,
          cog: `<svg width="20" height="20" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24"><circle cx="12" cy="12" r="3"/><path d="M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 1 1-2.83 2.83l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 1 1-4 0v-.09a1.65 1.65 0 0 0-1-1.51 1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 1 1-2.83-2.83l.06-.06a1.65 1.65 0 0 0 .33-1.82 1.65 1.65 0 0 0-1.51-1H3a2 2 0 1 1 0-4h.09a1.65 1.65 0 0 0 1.51-1 1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 1 1 2.83-2.83l.06.06a1.65 1.65 0 0 0 1.82.33h.09a1.65 1.65 0 0 0 1-1.51V3a2 2 0 1 1 4 0v.09a1.65 1.65 0 0 0 1 1.51h.09a1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 1 1 2.83 2.83l-.06.06a1.65 1.65 0 0 0-.33 1.82v.09a1.65 1.65 0 0 0 1.51 1H21a2 2 0 1 1 0 4h-.09a1.65 1.65 0 0 0-1.51 1z"/></svg>`,
          eye: `<svg width="20" height="20" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24"><ellipse cx="12" cy="12" rx="9" ry="5"/><circle cx="12" cy="12" r="2.5"/></svg>`,
          eyeSlash: `<svg width="20" height="20" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24"><ellipse cx="12" cy="12" rx="9" ry="5"/><circle cx="12" cy="12" r="2.5"/><line x1="3" y1="21" x2="21" y2="3"/></svg>`,
          google: `<svg width="20" height="20" viewBox="0 0 48 48"><g><path fill="#4285F4" d="M43.6 20.5H42V20H24v8h11.3C34.7 32.1 29.8 35 24 35c-6.1 0-11.3-4.1-13.1-9.6-1.8-5.5.2-11.5 5.1-14.7 4.9-3.2 11.5-2.7 15.8 1.2l6.4-6.4C34.1 1.7 29.2 0 24 0 10.7 0 0 10.7 0 24s10.7 24 24 24c12.3 0 22.4-9.3 23.9-21.2.1-.7.1-1.3.1-2 0-1.3-.1-2.6-.4-3.8z"/><path fill="#34A853" d="M6.3 14.6l6.6 4.8C14.5 16.1 19 13 24 13c3.1 0 6 .9 8.3 2.6l6.2-6.2C34.1 5.7 29.2 4 24 4c-7.2 0-13.6 3.7-17.2 9.6z"/><path fill="#FBBC05" d="M24 44c5.8 0 10.7-1.9 14.7-5.1l-6.8-5.6C29.9 34.7 27 35.5 24 35.5c-5.8 0-10.7-3.9-12.5-9.4l-6.7 5.2C6.4 40.3 14.5 44 24 44z"/><path fill="#EA4335" d="M43.6 20.5H42V20H24v8h11.3c-1.2 3.2-4.2 5.5-7.3 6.5l6.8 5.6C39.7 41.1 44 34.7 44 24c0-1.3-.1-2.6-.4-3.8z"/></g></svg>`,
          facebook: `<svg width="20" height="20" viewBox="0 0 32 32"><path fill="#1877F3" d="M32 16.1C32 7.2 24.8 0 16 0S0 7.2 0 16.1c0 8 6 14.6 13.8 15.8v-11.2h-4.2v-4.6h4.2v-3.5c0-4.1 2.5-6.4 6.2-6.4 1.8 0 3.7.3 3.7.3v4.1h-2.1c-2.1 0-2.7 1.3-2.7 2.6v3h4.6l-.7 4.6h-3.9v11.2C26 30.7 32 24.1 32 16.1z"/></svg>`,
          apple: `<svg width="20" height="20" viewBox="0 0 24 24"><path fill="#000" d="M16.365 1.43c0 1.14-.93 2.07-2.07 2.07-.02 0-.04 0-.06-.01-.02-.01-.03-.01-.05-.01-.02 0-.04 0-.06.01-.02.01-.04.01-.06.01-1.14 0-2.07-.93-2.07-2.07 0-1.14.93-2.07 2.07-2.07.02 0 .04 0 .06.01.02.01.03.01.05.01.02 0 .04 0 .06-.01.02-.01.04-.01.06-.01 1.14 0 2.07.93 2.07 2.07z"/><path fill="#000" d="M21.6 16.2c-.2.5-.4 1-.7 1.5-.3.5-.7 1-1.1 1.4-.4.4-.9.8-1.4 1.1-.5.3-1 .5-1.5.7-.5.2-1.1.3-1.7.3-.6 0-1.2-.1-1.7-.3-.5-.2-1-.4-1.5-.7-.5-.3-1-.7-1.4-1.1-.4-.4-.8-.9-1.1-1.4-.3-.5-.5-1-.7-1.5-.2-.5-.3-1.1-.3-1.7 0-.6.1-1.2.3-1.7.2-.5.4-1 .7-1.5.3-.5.7-1 1.1-1.4.4-.4.9-.8 1.4-1.1.5-.3 1-.5 1.5-.7.5-.2 1.1-.3 1.7-.3.6 0 1.2.1 1.7.3.5.2 1 .4 1.5.7.5.3 1 .7 1.4 1.1.4.4.8.9 1.1 1.4.3.5.5 1 .7 1.5.2.5.3 1.1.3 1.7 0 .6-.1 1.2-.3 1.7z"/></svg>`
          // Add more SVGs as needed for other icons (linkedin, microsoft, twitter, etc.)
        };

        function swapIconsToSVG() {
          // Header icons
          const infoBtn = document.querySelector('#open-side-panel-btn i');
          if (infoBtn && infoBtn.parentElement) infoBtn.parentElement.innerHTML = SVG_ICONS.info;
          const globeBtn = document.querySelector('#lang-icon i');
          if (globeBtn && globeBtn.parentElement) globeBtn.parentElement.innerHTML = SVG_ICONS.globe;
          const cogBtn = document.querySelector('#help-icon i');
          if (cogBtn && cogBtn.parentElement) cogBtn.parentElement.innerHTML = SVG_ICONS.cog;
          // Password eye icon
          const eyeIcon = document.getElementById('eyeIcon');
          if (eyeIcon && eyeIcon.parentElement) {
            if (eyeIcon.classList.contains('fa-eye-slash')) {
              eyeIcon.parentElement.innerHTML = SVG_ICONS.eyeSlash;
            } else {
              eyeIcon.parentElement.innerHTML = SVG_ICONS.eye;
            }
          }
          // Social buttons
          document.querySelectorAll('.fab.fa-google').forEach(el => el.outerHTML = SVG_ICONS.google);
          document.querySelectorAll('.fab.fa-facebook-f').forEach(el => el.outerHTML = SVG_ICONS.facebook);
          document.querySelectorAll('.fab.fa-apple').forEach(el => el.outerHTML = SVG_ICONS.apple);
          // Add more as needed
        }
        function swapIconsToFA() {
          // Header icons
          const infoBtn = document.getElementById('open-side-panel-btn');
          if (infoBtn) infoBtn.innerHTML = '<i class="fa-solid fa-wrench"></i>';
          const globeBtn = document.getElementById('lang-icon');
          if (globeBtn) globeBtn.innerHTML = '<i class="fa-solid fa-globe"></i>';
          const cogBtn = document.getElementById('help-icon');
          if (cogBtn) cogBtn.innerHTML = '<i class="fa-solid fa-cog"></i>';
          // Password eye icon
          const eyeSpan = document.querySelector('#password + span');
          if (eyeSpan) eyeSpan.innerHTML = '<i class="fa-regular fa-eye" id="eyeIcon"></i>';
          // Social buttons
          document.querySelectorAll('.grid.grid-cols-3 button').forEach(btn => {
            if (btn.innerHTML.includes('Google')) btn.innerHTML = '<i class="fab fa-google"></i> Google';
            if (btn.innerHTML.includes('Facebook')) btn.innerHTML = '<i class="fab fa-facebook-f"></i> Facebook';
            if (btn.innerHTML.includes('Apple')) btn.innerHTML = '<i class="fab fa-apple"></i> Apple';
          });
          // Add more as needed
        }
        function applySVGIcons() {
          const params = getCurrentParams();
          if (params.svgicons === 'on') {
            swapIconsToSVG();
          } else {
            swapIconsToFA();
          }
        }
        // On load
        applySVGIcons();
        // Patch paramForm rendering to call applySVGIcons after toggling
        const origRenderParamFormSVG = renderParamForm;
        renderParamForm = function (activeIdx = 0) {
          origRenderParamFormSVG(activeIdx);
          // Attach svgicons toggle logic
          const svgInput = document.querySelector('input[name="svgicons"]');
          if (svgInput) {
            svgInput.onchange = function () {
              const params = new URLSearchParams(window.location.search);
              if (svgInput.checked) params.set('svgicons', 'on');
              else params.delete('svgicons');
              window.history.replaceState({}, '', `${window.location.pathname}?${params}`);
              applySVGIcons();
              renderParamForm(activeParamTab);
            };
          }
        };
        // Initial patch call
        renderParamForm(activeParamTab);
        // Also call applySVGIcons on popstate (URL param change)
        window.addEventListener('popstate', applySVGIcons);

        // --- Badge/Counter on Settings Icon ---
        function updateSettingsBadge() {
          // Only attach badge to the settings (cog) icon, never to the info button
          const params = getCurrentParams();
          let count = 0;
          PARAMS.forEach(param => {
            if (param.type === 'checkbox' && params[param.key] === param.value) count++;
          });
          let badge = document.getElementById('settings-badge');
          const cogBtn = document.getElementById('help-icon');
          // Remove old badge if present
          if (badge) badge.remove();
          if (count > 0 && cogBtn) {
            badge = document.createElement('span');
            badge.id = 'settings-badge';
            badge.textContent = count;
            badge.style.position = 'absolute';
            badge.style.top = '2px';
            badge.style.right = '2px';
            badge.style.background = '#e11d48';
            badge.style.color = '#fff';
            badge.style.fontSize = '0.75rem';
            badge.style.fontWeight = 'bold';
            badge.style.borderRadius = '9999px';
            badge.style.padding = '0 6px';
            badge.style.height = '18px';
            badge.style.minWidth = '18px';
            badge.style.display = 'flex';
            badge.style.alignItems = 'center';
            badge.style.justifyContent = 'center';
            badge.style.zIndex = '10';
            badge.style.boxShadow = '0 1px 4px rgba(0,0,0,0.12)';
            // Position relative to icon
            cogBtn.style.position = 'relative';
            cogBtn.appendChild(badge);
          }
        }
        // Update badge on param panel open, tab switch, and checkbox toggle
        function patchBadgeEvents() {
          // On tab switch
          paramTabs.addEventListener('click', function (e) {
            setTimeout(updateSettingsBadge, 10);
          });
          // On checkbox toggle
          paramForm.addEventListener('change', function (e) {
            if (e.target && e.target.type === 'checkbox') updateSettingsBadge();
          });
          // On panel open
          const cogBtn = document.getElementById('help-icon');
          if (cogBtn) cogBtn.addEventListener('click', function () {
            setTimeout(updateSettingsBadge, 100);
          });
        }
        patchBadgeEvents();
        // Also update badge after rendering param form
        const origRenderParamFormBadge = renderParamForm;
        renderParamForm = function (activeIdx = 0) {
          origRenderParamFormBadge(activeIdx);
          updateSettingsBadge();
          // ...existing SVG/param logic...
          const svgInput = document.querySelector('input[name="svgicons"]');
          if (svgInput) {
            svgInput.onchange = function () {
              const params = new URLSearchParams(window.location.search);
              if (svgInput.checked) params.set('svgicons', 'on');
              else params.delete('svgicons');
              window.history.replaceState({}, '', `${window.location.pathname}?${params}`);
              applySVGIcons();
              renderParamForm(activeParamTab);
            };
          }
        };
        // Initial badge update
        updateSettingsBadge();

        // --- Ensure checkboxes reflect URL params on load and param change ---
        function syncCheckboxesWithParams() {
          const params = getCurrentParams();
          PARAMS.forEach(p => {
            if (p.type === 'checkbox') {
              const input = document.querySelector(`input[name='${p.key}']`);
              if (input) input.checked = params[p.key] === p.value;
            }
          });
        }
        // Patch paramForm rendering to sync checkboxes and update badge
        const origRenderParamFormSync = renderParamForm;
        renderParamForm = function (activeIdx = 0) {
          origRenderParamFormSync(activeIdx);
          syncCheckboxesWithParams();
          updateSettingsBadge();
          // ...existing SVG/param logic...
          const svgInput = document.querySelector('input[name="svgicons"]');
          if (svgInput) {
            svgInput.onchange = function () {
              const params = new URLSearchParams(window.location.search);
              if (svgInput.checked) params.set('svgicons', 'on');
              else params.delete('svgicons');
              window.history.replaceState({}, '', `${window.location.pathname}?${params}`);
              applySVGIcons();
              renderParamForm(activeParamTab);
            };
          }
        };
        // On load, sync checkboxes and update badge
        syncCheckboxesWithParams();
        updateSettingsBadge();
        // Also update badge and checkboxes on popstate (URL param change)
        window.addEventListener('popstate', function () {
          syncCheckboxesWithParams();
          updateSettingsBadge();
        });

        // --- Sun/Moon Dark Mode Toggle ---
        const sunSVG = `<svg width="20" height="20" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24"><circle cx="12" cy="12" r="5"/><path d="M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"/></svg>`;
        const moonSVG = `<svg width="20" height="20" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24"><path d="M21 12.79A9 9 0 1 1 11.21 3a7 7 0 0 0 9.79 9.79z"/></svg>`;
        const themeToggleBtn = document.getElementById('theme-toggle');
        function setThemeIcon(isDark) {
          if (themeToggleBtn) themeToggleBtn.innerHTML = isDark ? moonSVG : sunSVG;
        }
        function setDarkMode(isDark) {
          document.body.classList.toggle('dark', isDark);
          setThemeIcon(isDark);
        }
        function updateThemeParam(isDark) {
          const params = new URLSearchParams(window.location.search);
          if (isDark) params.set('theme', 'on');
          else params.delete('theme');
          window.history.replaceState({}, '', `${window.location.pathname}?${params}`);
        }
        if (themeToggleBtn) {
          themeToggleBtn.onclick = function () {
            const isDark = !document.body.classList.contains('dark');
            setDarkMode(isDark);
            updateThemeParam(isDark);
          };
        }
        // On page load, set mode and icon from URL param
        const urlParamsTheme = new URLSearchParams(window.location.search);
        const darkFromUrl = urlParamsTheme.get('theme') === 'on';
        setDarkMode(darkFromUrl);

        // --- About Us Infinite Scroll Modal ---
        const aboutBtn = document.getElementById('about-btn');
        const aboutOverlay = document.getElementById('about-overlay');
        const aboutClose = document.getElementById('about-close');
        const aboutContent = document.getElementById('about-content');
        const aboutLoading = document.getElementById('about-loading');
        let aboutLineCount = 0;
        let aboutLoadingMore = false;
        function loadAboutLines(count = 30) {
          aboutLoadingMore = true;
          aboutLoading && (aboutLoading.style.display = 'block');
          setTimeout(() => {
            for (let i = 0; i < count; i++) {
              aboutLineCount++;
              // Add a line with extra padding and line height
              const line = document.createElement('div');
              line.className = 'w-full text-left py-4 border-b border-purple-100 text-base';
              line.style.lineHeight = '2.1';
              line.style.paddingLeft = '0.5rem';
              line.textContent = `About Us Line #${aboutLineCount}`;
              aboutContent.appendChild(line);
              // After every 10 lines, add an accordion
              if (aboutLineCount % 10 === 0) {
                const accordion = document.createElement('div');
                accordion.className = 'w-full my-2 rounded-lg border border-purple-200 bg-purple-50 shadow-sm';
                accordion.innerHTML = `
              <button class="accordion-toggle w-full flex justify-between items-center px-4 py-3 font-semibold text-purple-700 focus:outline-none">
                <span>What is Visual Testing?</span>
                <span class="accordion-arrow">&#9660;</span>
              </button>
              <div class="accordion-content px-4 pb-4 text-gray-700 text-sm hidden">
                Visual testing is the process of verifying that the user interface of an application appears correctly to users. It helps catch visual bugs, layout issues, and unintended UI changes by comparing screenshots or DOM snapshots across versions or environments. Automated visual regression tools make this process efficient and reliable.
              </div>
            `;
                aboutContent.appendChild(accordion);
              }
            }
            // Accordion toggle logic
            aboutContent.querySelectorAll('.accordion-toggle').forEach(btn => {
              btn.onclick = function () {
                const content = btn.nextElementSibling;
                const arrow = btn.querySelector('.accordion-arrow');
                if (content.classList.contains('hidden')) {
                  content.classList.remove('hidden');
                  arrow.innerHTML = '&#9650;';
                } else {
                  content.classList.add('hidden');
                  arrow.innerHTML = '&#9660;';
                }
              };
            });
            aboutLoading && (aboutLoading.style.display = 'none');
            aboutLoadingMore = false;
          }, 400); // Simulate async/lazy load
        }
        function showAboutOverlay() {
          aboutOverlay.classList.remove('hidden');
          aboutContent.innerHTML = '';
          aboutLineCount = 0;
          loadAboutLines();
          // Hide settings badge if present
          const badge = document.getElementById('settings-badge');
          if (badge) badge.style.display = 'none';
        }
        function hideAboutOverlay() {
          aboutOverlay.classList.add('hidden');
          // Show settings badge again if present
          const badge = document.getElementById('settings-badge');
          if (badge) badge.style.display = '';
        }
        if (aboutBtn) aboutBtn.onclick = showAboutOverlay;
        if (aboutClose) aboutClose.onclick = hideAboutOverlay;
        // Infinite scroll logic
        if (aboutOverlay) {
          aboutOverlay.onscroll = function () {
            if (aboutLoadingMore) return;
            if (aboutOverlay.scrollTop + aboutOverlay.clientHeight >= aboutOverlay.scrollHeight - 120) {
              loadAboutLines();
            }
          };
        }
      });
    })();
  </script>
</body>

</html>
